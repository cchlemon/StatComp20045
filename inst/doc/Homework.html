<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20045" />

<meta name="date" content="2020-12-19" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">20045</h4>
<h4 class="date">2020-12-19</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>1,show data by tables</p>
<p>2,show data by figures</p>
<p>3,outpot mathematical formulas</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>1,Recently,researchers have carried out an investigation about three species of iris and some kinds of cars.We selected twenty data about iris and some data about cars as follows.</p>
</div>
<div id="cars" class="section level1">
<h1>cars</h1>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Porsche 914-2</td>
<td align="right">26.0</td>
<td align="right">4</td>
<td align="right">120.3</td>
<td align="right">91</td>
<td align="right">4.43</td>
<td align="right">2.140</td>
<td align="right">16.7</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Lotus Europa</td>
<td align="right">30.4</td>
<td align="right">4</td>
<td align="right">95.1</td>
<td align="right">113</td>
<td align="right">3.77</td>
<td align="right">1.513</td>
<td align="right">16.9</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Ford Pantera L</td>
<td align="right">15.8</td>
<td align="right">8</td>
<td align="right">351.0</td>
<td align="right">264</td>
<td align="right">4.22</td>
<td align="right">3.170</td>
<td align="right">14.5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">Ferrari Dino</td>
<td align="right">19.7</td>
<td align="right">6</td>
<td align="right">145.0</td>
<td align="right">175</td>
<td align="right">3.62</td>
<td align="right">2.770</td>
<td align="right">15.5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">Maserati Bora</td>
<td align="right">15.0</td>
<td align="right">8</td>
<td align="right">301.0</td>
<td align="right">335</td>
<td align="right">3.54</td>
<td align="right">3.570</td>
<td align="right">14.6</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">Volvo 142E</td>
<td align="right">21.4</td>
<td align="right">4</td>
<td align="right">121.0</td>
<td align="right">109</td>
<td align="right">4.11</td>
<td align="right">2.780</td>
<td align="right">18.6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="iris" class="section level1">
<h1>iris</h1>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10</td>
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="right">5.4</td>
<td align="right">3.7</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="right">4.8</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="right">4.3</td>
<td align="right">3.0</td>
<td align="right">1.1</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="right">5.8</td>
<td align="right">4.0</td>
<td align="right">1.2</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="right">5.7</td>
<td align="right">4.4</td>
<td align="right">1.5</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.3</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="right">5.7</td>
<td align="right">3.8</td>
<td align="right">1.7</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="right">5.1</td>
<td align="right">3.8</td>
<td align="right">1.5</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="right">5.4</td>
<td align="right">3.4</td>
<td align="right">1.7</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="right">5.1</td>
<td align="right">3.7</td>
<td align="right">1.5</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="right">4.6</td>
<td align="right">3.6</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="right">5.1</td>
<td align="right">3.3</td>
<td align="right">1.7</td>
<td align="right">0.5</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="right">4.8</td>
<td align="right">3.4</td>
<td align="right">1.9</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">26</td>
<td align="right">5.0</td>
<td align="right">3.0</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">27</td>
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.6</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">28</td>
<td align="right">5.2</td>
<td align="right">3.5</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="left">29</td>
<td align="right">5.2</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="left">30</td>
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>2,There are some data about weight and group</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZmUAZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j7U5j9plAABlADllAGVlOQBlOTllOWVlOY9lZgBlZjllZmVlZo9lZrVlj7Vlj9pltdpltf2POQCPOTmPOWWPZjmPZmWPZo+PjzmPj9qP29qP2/21ZgC1Zjm1ZmW1Zo+1jzm1j2W12/21/rW1/v2+vr7ajznaj2Xaj4/atWXa24/a/rXa/tra/v3fU2v9tWX924/927X929r9/rX9/tr9/v0nAV3tAAAAR3RSTlP/////////////////////////////////////////////////////////////////////////////////////////////AMecVm8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAnbSURBVHic7Z0Ne9u0GoZxexaSjeawZG032Dkc0o0BJ+kYYAK0BBsc//+fhCTLbprWfhxLjt5kz32tzRLLX3elV5YsK5/kpJFPQh+AdCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggBhBKWjKIqG9z8ar/J8fTV78Fn9Bibp+PbVKnt1l2hrfR8EEqTOPHsxf/B5e0F2iXrdTHRUgvLFLE90PlpfqcygP1pGTy5m6nX9Zp4v9ZJ0/IdZplhO9M+6fFtYSc8u1CrRYGW2k5v1fR9q0BykXxazZJhn53E6vnkWpyMrSP02n/1ulhVrqI+T6q0qYgOVeW5MDiq2k5r1fR9qwBg00RlIR5KR/vOn4w8TnatsDlIfnihNN6MyVF3P08/ztHxrc5AVVGxnadb3fajBcpAOQYk9eXXesw1BalFyGtscppfpNMnQnLx9uyXIbOfIBOW6RDydq7C6VKe3mJgilk1nxcfqlBOdgz6YZXqV7OXLOF+Wb+8LKraTmvV9H2rIIF0G10URT1SQPvlspt49uZxn0+jTqc5NZplZZ6Gz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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZmUAZrU5AAA5ADk5AGU5OWU5OY85ZmU5Zo85ZrU5j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZmVlZo9lZrVlj49lj7Vlj9pltdpltf1/f3+POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj9qPtY+P29qP2/21ZgC1Zjm1ZmW1Zo+1jzm1j2W1tdq124+12/21/rW1/v3ajznaj2Xaj4/atWXa24/a/rXa/tra/v39tWX924/927X9/rX9/tr9/v1qpW4wAAAAR3RSTlP/////////////////////////////////////////////////////////////////////////////////////////////AMecVm8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAsOSURBVHic7Z0Ne+I2FkbrpClkQrf5mMl0drstpNnp7raQabfbgXaSYi/2//9JqyvJRmDDK38ICXPPM0kAG9mcka6sK9t8ljF7+cz3DoQOCwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKEIii5nGbp99Odi0dL+jOLokH+kvnYIcEIGg6woNlA/WRbj10SjKDR+ykJWkTRTZZcvTn/79Wb6PpBPFlQTZGCVq/n+tfmY6eEI+j5KyEoeTVf3U2pvYkf+jd6Hi2FBylI/tLVzHzslHAELZ9++n4aU8MZ06cXP/rfMDqbsiAy8ZcqQZ/OZZ3STSz9Vfyi8Jw/dr5jAQnKZmd5EzMFDbJY1yAKyjMRlSTmY5eEJIhCjwjJ48wU9HIbfXE7Xnfz3wxzQ8Zjh4QiKFhYEIAFAVgQgAUBWBCABQE6FhQdDb4EdVucO5oJigerW3Ege4jt+qaRIDE4Xgz0Qb3r7fqmkSAaKN+0GyH3W1D6+FEnFtxv1zcNY1B08XLXKgfVc0EH3K5vGggSHZjknGOQyYnUoJ/n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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA2FBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZmUAZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j7U5j9plAABlADllAGVlOQBlOTllOWVlOY9lZgBlZjllZmVlZo9lZrVlj7Vlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmPj9qP27WP29qP2/21ZgC1Zjm1ZmW1Zo+1jzm1j2W12/21/rW1/v3ajznaj2Xaj4/atWXa24/a/rXa/tra/v3fU2v9tWX924/927X929r9/rX9/tr9/v0VS6VMAAAASHRSTlP//////////////////////////////////////////////////////////////////////////////////////////////wCc7PJgAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKi0lEQVR4nO2dC3vbthlGS3t1pWxWF8mOmzW7lEra7iY53VqxjT2N3Cj+/39UALyIskS+EAGIEPWep3FcCSHE8+D6AYQ+y0grn/X9AXyHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI0LugOAiCcOeVZLI++Hud9O266S3L9C0o+e0qS14tdl7SEHQiO5kHgoo7TcbB9SqLgmAkX4rl37W3xevTeprNPLh5mqzVy8mXsyKxE/oWlC3lTWfp3SKLRkJHer9KJuLes6Wqd7kgUcxEgt00ooo9qZflm/crZ5+vd0FCzux6VZQUUUauFsnkk2iXZJEpBcWihCzD3TRC0Kfy5c37Rcv1zfBAkKhB00LEtSoS6s5l2QpG+4LKNJciSNxvtpmHsvrEN+KOY1k6nl4txGvy7ZdVbJtmW8WGLUi2uVUDnM6CL2bhTiM9DuSvkRoK1NKks6KRDrOhC/IdCgJQECAXFPT8KTymEhRU9PyJPGOnBMUj0UeELakvkLog0VtGo9NNA8+DuiAxpVlOzeY1wdnQRdDmw09qYGoiqLBkcInT0ElQFgc3z3dGg9Kg9if7YfXzu3d//NHkes7oJshKvkHxy+a7W1FZkz/ZurRdOggSHZji2qgNqglafxTz0O/dRWqM8KAEZZkQFP/F1pUt001QZKMEbdsgIejR3TTbjE6C0rvFMoy7xHd3e8+yF/u42nzwtIZ1FHS/ikzHQepHIeiH1eb7d3/2c9zZbRz0fiEmG8aCij+yF0t8bYK6joNu/jPPg+UG+dZ7sfj24RuTy7nDk17sf2vZUvtItzZoZnMcJAX98qOv/Vj3EhSbVrGs6s0+rpLb716bXM4BZU+rm35PkIVG+pjJ8gmJZKRrZ6Cmw54guZugOztVzC+Sh7D24QzaIFDFkrFcsmoqZ/4K2vz1k7EgrXzmoVr9PTtBPy9iQ0F6s3llJr3/qVnQcVX8VGz+/e5BhgLN2iC55QTMxfJV3vShoaXyOaIYq+UIk16sKB3tjXQylvnEDeXMSzOH6DYXkzsq4hvjmPQ50K2KyWZIz8+Lcnb8YkHf9DgX85zubZDomqzMxbxtpBXmI+kT539iDAeK5mvz/g4Uc8wE6azNg+HksAVprc2nrUuvvgsya4P01uZbB0q+t0GG8SA7a/Ne92IlHAcBOo+kvzHbcjxsQWIuVj0R4Trfvunci4UWVlbPge4liLP5XfZm852mYhcym7fwXBoF2cq3b7rHpE+Ub28YxaQtxYN8pmwoOZI+TC7H5cIh+gC2LuSIQFWxvgV53NufoAQl46t/zBobKt/DHSaC9JaeNx/kk8by7IzDH8DzgFk1nHW29CzGSnK41L554b8v0P0w7jFrg3SWnosS1DTnP1yCXgrrUaBRN6+19BwH9tugE/ozGwfpLz035l98CJNr7GHRn+G6mD4+rc0fU4ENBQ0z5LovrPPC4QWEXI3WxbRCrrGqSVcN5cz3kbTZbF4n5LpzbM2B7LMuvVgPOAu5FgXs/Ha5vsBZL1aWoOZNnJ4LMguYhTqbOEEb5Lcgs0b67behjWc1jsn/xJiNg2wcTaF++NuLGQvKotdGz+EOX1AW2Xss3EeM2iA7+VchFz/pfxtwFdX0mhOXoPps3u9uvsRZTBrnO+QSpBGTxvl63gYVOItJa+TrdS9W4i4mrZGvx+Ogil5j0udA9ypmId/BliBLgvxug4x22lvZQOX3OMhoXUx7A1XzAde+C3K/u+OiH4fSOuQtGU/bS5DXbZDh5gW9Q96iq3+2CvK5FzOrYrqHvG3mTSFpb0tOidn+IEuHvPmM4R5F/UPefNq8cAyGjbStD+AxBiFXW/EgzzEeSaNeTGPzwjngLB6ksXnhLHAWD8KbF84DZ/EgvHnhPHDXi8HNC+eBu7mYpXz7putc7GT59g1DroAeI4pehzsq3EYUW/P1OmBW0eNcbMiCOvdiF7F5weRrI3byHXAbZPlrI3yGEUWA64iicb59w4giwFk8yFa+fdNB0Gaed9Q8YGmHo+diFxxylc+yLNE48ZJDrmKqGt+sGXLdpb6RfJVFU92g/QWGXIUZuWvD+Hmx86BTLxbKchEZz8XOgi5tkCgb4WbOQ/934UgaYPn75gcsSJcLHShql5sLHShmZRWD6dFA8Ww4WtD2BlvTg4FiA/oFq9+UB9gThP5B+0CxgaEIcjaMGYogZ23sYAS5goIAFASgIAAFAShouFAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCOBcUqZ376jkisIc/TymToj1cRcplELQ/Abgsn12KUcpmXAuS5zEVv4HV6iJlMlkXy9soZXyzbj7pSVK9m94tjlwr3+JY0Ob916Ug8LxnmVIKav92mDKlLEdRW6mspOBrNuNYUDQtbwF940uVMhmDhf8ypSxB8zZB8W/GeW2Vz8B1fR7XrSBhpRS0bG+BqpTqtttuZnvNZXD1detV/7/OInkpfwVt22a0u7hKKW++9anHnfYe3rZy6XEVq1oJje9UqkoQKm1lyhFo+KVnVYI8bqSzcvO+xqOwRcqlVjdfpITdfJG7v9382UNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAggBeC1JlE02Ty/Hadvt1utNrfiqexDcs2fggq7lv8XVdAQSX5fSe3b4LP3wQ361jtMYvE/0hBxW5ftb88mTzl2w1VEnkCttEB8zr4IWgsz/lWd18UoqU8NjUZS0H5DkzxM71flYLyJPHIxtcRAfwQlJegQlCstrHKgpPvYX1cJL9XEq8WpaA8STKGuxnN8VGQuuutoHgkT7q+Xsm9qjKJ+LvcEiqPn3X82TwUlLxa5CcTyyPSBelXX6ldsrEqQaLmvVrkSeTBxWjHsDFeCXqe3Yj/qkb66nd58ViO1DdXfTELRcJl8PlD0UjLbb5GX1GggxeCfIaCABQEoCAABQEoCEBBAAoCUBCAggAUBOhHUD0yuP/oey3AKH7Wg7CAI5Jq07sgGetpTXVMmDW2P7fvS9DT7ZvgtfxKzseFUiBm7FUoVQXNrv8WyhjsaDN/MWMv37peRTLiWgQcZdIs23ywHmDsTZAK6iST5/uVNJM+1KOtk+e7RToLRQIVZlUVbXa1SP+eqUe887fkM+EqhqYEqQBR8RS4VXoTVAh5krcfTePp40I0RkUoVb0qRZXx5yz7ZZXO1EkupcN1cZ7CNhE8y6MTXghKJv8K49eyho2qd18Iqv3TPUF5ORqoIFnFRB27XSVfii6oiLaWVeyQoLR8q6xitRhs9xM6mulb0PpRnqkRlQe51BrpPxSC0tleI63eUqd4SCcyBju0RrpGUzffchrJgbeKYjaYbr7OoWYjnTWumR5+6+gxpTb9C/IcCgJQEOBX1WhvfavAscAAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZmUAZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j7U5j9plAABlADllAGVlOQBlOTllOWVlOY9lZgBlZmVlZo9lZrVlj7Vlj9pltdpltf2POQCPOTmPOWWPZgCPZjmPZmWPZo+PjzmP2/21ZgC1Zjm1ZmW1Zo+1jzm1j2W12/21/rW1/tq1/v2+vr7ajznaj2Xaj4/atWXa24/a27Xa29ra2/3a/rXa/tra/v3fU2v9tWX924/927X9/rX9/tr9/v3PBZ4uAAAAR3RSTlP/////////////////////////////////////////////////////////////////////////////////////////////AMecVm8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAssSURBVHic7Z0Jf5vGFsWLHVW2a7eR4jhpuknN6yIn7WtK1Bd3U6HA9/9IbxYWbegMMAyLz/nFMqDRxfwzc2fubPoooU7qo67/gL6LgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAioE0Dx0vMWR65HLzeHp+HN5khSZ+oCULycJdGz1eEbeyz06SMEpB759z+TtefNkvDTuTdVeWomXiYbcXGqL6rTHFAgr69nifxRx+H183NfpRbn5z8u9NXo1rf7x3YBKJiqX+GVL/KRfL31A/VogoX4Jw/Uxe0cJF/vF+I1/naVHl+uEp1aWInmC33V+h/bISD5K3/mC5kT5DOKo7NVASIDJLKHzG9vVuFn6bG6nqUWhtIUttVZEdsFpB5VHgfnKlsdAsqgikyij+X1PLUENG3lj+3MSc9naRFTLNYSlswU4jGDYzlIFKh4uUiiFy/89FgBUqnTIqZT2FYn1Xw0V4VhLSv7NAfde8IjR/PJX3Pv43marcSpLkXS+yoXLCjKF+2kBaBIpZZO+vMxOekWpEppKxoDoDRDtqMxAGpVBAREQEAuAKX10M4lWXfv1crlQZcysONl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" /><!-- --></p>
<p>3,limitation,integral and differential</p>
<p><span class="math display">\[
\lim _{n \rightarrow \infty} \frac{1}{n^{2}+n+1}+\frac{2}{n^{2}+n+2}+\cdots+\frac{n}{n^{2}+n+n}
\]</span></p>
<p><span class="math display">\[
\int\left(\sum_{k} a_{k} 1_{S_{k}}\right) d \mu=\sum_{k} a_{k} \int 1_{S_{k}} d \mu=\sum_{k} a_{k} \mu\left(S_{k}\right)
\]</span></p>
<p><span class="math display">\[
f\left(x, \frac{d^{n} y}{d x^{n}}, \frac{d^{(n-1)} y}{d x^{(n-1)}}, \cdots, \frac{d y}{d x}, y\right)=0
\]</span></p>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3, 3.9, 3.10, and 3.13 (pages 94-95, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.3 when a,b =2,<span class="math inline">\(F(x)=1-\left(\frac{2}{x}\right)^{2}, \quad x \geqslant 2\)</span>.then: <span class="math display">\[
x=\frac{2}{(1-F(x))^{\frac{1}{2}}}
\]</span> then: <span class="math display">\[
F^{-1}(x)=\frac{2}{(1-x)^{\frac{1}{2}}}
\]</span> make <span class="math inline">\(u \sim u(0,1)\)</span> <span class="math display">\[
x=\frac{2}{(1-u)^{\frac{1}{2}}}
\]</span> then <span class="math display">\[
x=\frac{2}{u^{\frac{1}{2}}}
\]</span></p>
<p>then <span class="math display">\[
\frac{d(F(x))}{d x}=f(x)=\frac{d\left(1-\left(\frac{2}{x}\right)^{2}\right)}{d x}=8 \frac{1}{x^{3}}
\]</span></p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>k&lt;-<span class="dv">0</span>;j&lt;-<span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>y&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="cf">while</span>(k<span class="op">&lt;</span>n)</span>
<span id="cb1-5"><a href="#cb1-5"></a>{x&lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">^</span><span class="fl">0.5</span>;j&lt;-j<span class="op">+</span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">if</span>(x<span class="op">&lt;</span><span class="dv">24</span>){k&lt;-k<span class="op">+</span><span class="dv">1</span>;y[k]&lt;-x}</span>
<span id="cb1-7"><a href="#cb1-7"></a>}</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">hist</span>(y,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="dv">2</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>x<span class="op">^</span><span class="dv">3</span>))</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">lines</span>(z&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">24</span>,<span class="fl">0.1</span>),<span class="dv">8</span><span class="op">/</span>z<span class="op">^</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.9 codes as follows</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>k&lt;-<span class="dv">0</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>e&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="cf">while</span>(k<span class="op">&lt;</span>n){</span>
<span id="cb2-5"><a href="#cb2-5"></a>  u1&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>  u2&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>  u3&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u2)</span>
<span id="cb2-9"><a href="#cb2-9"></a>     <span class="op">&amp;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="st">     </span><span class="kw">abs</span>(u3)<span class="op">&gt;=</span><span class="kw">abs</span>(u1)){</span>
<span id="cb2-11"><a href="#cb2-11"></a>    k&lt;-k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>    e[k]&lt;-u2</span>
<span id="cb2-13"><a href="#cb2-13"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="cf">else</span>{</span>
<span id="cb2-15"><a href="#cb2-15"></a>    k&lt;-k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>    e[k]&lt;-u3</span>
<span id="cb2-17"><a href="#cb2-17"></a>  }</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="kw">hist</span>(e,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb2-20"><a href="#cb2-20"></a>c&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="kw">lines</span>(c,<span class="dv">3</span><span class="op">/</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>c<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.10</p>
<p>make<span class="math inline">\(X\)</span>denotes the random variable.make<span class="math inline">\(Z=|X|\)</span>,so<span class="math inline">\(U_1,U_2,U_3\stackrel{iid}\sim u(-1,1)\)</span>,so <span class="math inline">\(|U_1|,|U_2|,|U_3|\stackrel{iid}\sim u(-1,1)\)</span>,and the density functionis <span class="math inline">\(f_{|U_1|,|U_2|,|U_3|}(x,y,z)=1\)</span>.noting <span class="math inline">\(B=\{|U_3|\geqslant|U_2|,|U_3|\geqslant|U_1|\}\)</span>,then <span class="math display">\[
p(Z\leqslant t)=p(Z\leqslant t,B)+p(Z\leqslant t,\stackrel{-}B)=p(|U_2|\leqslant t,B)+p(|U_3|\leqslant t)-p(|U_3|\leqslant t,B)
\]</span> and <span class="math display">\[
p(|U_2|\leqslant t,B)=\int_0^td|u_2|\int_{|U_2|}^1d|u_3|\int_0^{|u_3|}d|u_1|
\]</span> <span class="math display">\[
=\int_0^td|u_2|\int_{|U_2|}^1|u_3|d|u_3|
\]</span> <span class="math display">\[
=\int_0^t \frac{1}{2}(1-|u_2|^2)d|u_2|
\]</span> <span class="math display">\[
=\frac{1}{2}\int_0^t(1-|u_2|^2)d|u_2|
\]</span> <span class="math display">\[=\frac{1}{2}t-\frac{1}{6}t^3\]</span> <span class="math display">\[p(|U_3|\leqslant t)=t\]</span> <span class="math display">\[p(|U_3|\leqslant t,B)=\int_0^td|u_3|\int_0^{|u_3|}d|u_2|\int_0^{|u_3|}d|u_1|\]</span> <span class="math display">\[=\int_0^t|u_3|^2d|u_3|\]</span> <span class="math display">\[=\frac{1}{3}t^3\]</span> <span class="math inline">\(\therefore p(Z\leqslant t)=p(|X|\leqslant t)=-\frac{1}{2}t^3+\frac{3}{2}t\)</span></p>
<p><span class="math inline">\(\therefore F_{|X|}(t)=-\frac{1}{2}t^3+\frac{3}{2}t\)</span></p>
<p><span class="math inline">\(\therefore f_{|X|}(t)=\frac{dF_{|X|}(t)}{dt}=\frac{3}{2}(1-t^2)\)</span></p>
<p><span class="math inline">\(\because \mbox{the density function of X}\)</span></p>
<p>$f_X(t)=(1-t^2) $</p>
<p>3.13 when<span class="math inline">\(r=4, \beta=2\)</span>,then <span class="math inline">\(F(y)=1-\left(\frac{2}{2+y}\right)^{4}, y \geqslant 0\)</span> compute the density function: <span class="math display">\[
y=\frac{2}{(1-F(y))^{\frac{1}{4}}}-2
\]</span> then: <span class="math display">\[
F^{-1}(x)=\frac{2}{(1-y)^{\frac{1}{4}}-2}
\]</span> so <span class="math display">\[
x=\frac{2}{u^{\frac{1}{4}}}-2
\]</span></p>
<p>codes as follows</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>k&lt;-<span class="dv">0</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>y&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="cf">while</span>(k<span class="op">&lt;</span>n){</span>
<span id="cb3-5"><a href="#cb3-5"></a>  x&lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">^</span><span class="fl">0.25</span><span class="dv">-2</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="cf">if</span>(x<span class="op">&lt;</span><span class="dv">10</span>){k&lt;-k<span class="op">+</span><span class="dv">1</span>;y[k]&lt;-x}</span>
<span id="cb3-7"><a href="#cb3-7"></a>}</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">hist</span>(y,<span class="dt">prob=</span><span class="ot">TRUE</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>d&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">lines</span>(d,<span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>d)<span class="op">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.7, and 5.11 (pages 149-151, Statistical Computating with R).</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>5.1 First step: compute the integral <span class="math display">\[ 
\begin{align}
\int_0^{\frac{\pi}{3}}sint\mathrm{d}t\\
&amp;= -cost|_0^{\frac{\pi}{3}}\hfill\\
&amp;= -cos(\frac{\pi}{3})-(-cos(0))\\
&amp;= -\frac{1}{2}-(-1)\\
&amp;= \frac{1}{2}\\
\end{align}
\]</span> Second step:estimate <span class="math display">\[
\begin{align}
\int_0^{\frac{\pi}{3}}sint\mathrm{d}t\\
&amp;= \int_0^{\frac{\pi}{3}} \frac{\pi}{3}sint \frac{1}{\frac{\pi}{3}}\mathrm{d}t\\
&amp;= \int_0^{\frac{\pi}{3}} \frac{\pi}{3}sint f_U (t)\mathrm{d}t\\
\end{align}
\]</span> and<span class="math inline">\(f_U (t)=\frac{1}{\frac{\pi}{3}}\)</span>is the uniformly distribution u(0,<span class="math inline">\(\frac{\pi}{3}\)</span>) function,U is the random variable</p>
<p><span class="math inline">\(\therefore\)</span></p>
<p><span class="math display">\[
\begin{align}
\int_0^{\frac{\pi}{3}}sint\mathrm{d}t
&amp;= E\left(g(U)\right)
\end{align}
\]</span> and <span class="math inline">\(g(U)=\frac{\pi}{3} sin\left(U\right)\)</span></p>
<p>then generate random number of<span class="math inline">\(g(U)\)</span>.codes as follows</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>u&lt;-<span class="kw">runif</span>(<span class="fl">1e4</span>,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>y&lt;-pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">sin</span>(u)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.4997336</code></pre>
<p><span class="math inline">\(\therefore\mbox{estimteo is }0.4997336,\mbox{true value is }0.5,\mbox{among the erros}\)</span></p>
<p>5.7 the simple Monte Carlo method: <span class="math display">\[
\begin{align}
\theta&amp;=\int_0^1e^x\mathrm{d}x\\
&amp;=\int_0^1 1\times e^x \mathrm{d}x\\
&amp;=\int_0^1 f(x)\times e^x \mathrm{d}x\\
&amp;=E\left(e^U\right)
\end{align}
\]</span></p>
<p>antithetic variate approach:<span class="math inline">\(\hat{\theta_2}=\frac{1}{n}\sum_{i=1}^{n} \left(e^{1-X_i}+e^{X_i}\right)\)</span></p>
<p><span class="math inline">\(\mbox{codes as follows}\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>MC_modify_variance&lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</span>
<span id="cb6-2"><a href="#cb6-2"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</span>
<span id="cb6-4"><a href="#cb6-4"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</span>
<span id="cb6-5"><a href="#cb6-5"></a>  cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</span>
<span id="cb6-7"><a href="#cb6-7"></a>    g &lt;-<span class="st"> </span>x[i] <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(u <span class="op">*</span><span class="st"> </span>x[i])</span>
<span id="cb6-8"><a href="#cb6-8"></a>    cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g)</span>
<span id="cb6-9"><a href="#cb6-9"></a>  }</span>
<span id="cb6-10"><a href="#cb6-10"></a>  cdf</span>
<span id="cb6-11"><a href="#cb6-11"></a>}</span>
<span id="cb6-12"><a href="#cb6-12"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>theta_<span class="dv">1</span> &lt;-<span class="st"> </span>theta_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb6-14"><a href="#cb6-14"></a>x &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb6-16"><a href="#cb6-16"></a>  theta_<span class="dv">1</span>[i] &lt;-<span class="st"> </span><span class="kw">MC_modify_variance</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a>  theta_<span class="dv">2</span>[i] &lt;-<span class="st"> </span><span class="kw">MC_modify_variance</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb6-18"><a href="#cb6-18"></a>}</span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="kw">mean</span>(theta_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1.718303</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">mean</span>(theta_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1.717728</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">c</span>(<span class="kw">sd</span>(theta_<span class="dv">1</span>),<span class="kw">sd</span>(theta_<span class="dv">2</span>),<span class="kw">sd</span>(theta_<span class="dv">2</span>)<span class="op">/</span><span class="kw">sd</span>(theta_<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 0.015808279 0.002821124 0.178458664</code></pre>
<p>5.11 equation (5.11) <span class="math display">\[
var(\hat{\theta_c})=var(\hat{\theta_2})+c^2 var(\hat{\theta_1}-\hat{\theta_2})+2ccov(\hat{\theta_2},\hat{\theta_1}-\hat{\theta_2})
\]</span> <span class="math inline">\(\mbox{iif}\\\)</span> <span class="math display">\[
\begin{align}
c&amp;=-\frac{2cov(\hat{\theta_2},\hat{\theta_1}-\hat{\theta_2})}{2 var(\hat{\theta_1}-\hat{\theta_2})}\\
&amp;=\frac{cov(\hat{\theta_2},\hat{\theta_2}-\hat{\theta_1})}{var(\hat{\theta_1}-\hat{\theta_2})}\\
&amp;=\frac{var(\hat{\theta_2})-cov(\hat{\theta_2}-\hat{\theta_1})}{var(\hat{\theta_2})+var(\hat{\theta_1})-2cov(\hat{\theta_2},\hat{\theta_1})}\\
\end{align}
\]</span> <span class="math inline">\(var(\hat{\theta_c})\mbox{ got the minimum}\)</span></p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on<span class="math inline">\((1,+\infty)\)</span> and are close to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}{2}},x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}dx
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-5.13" class="section level2">
<h2>Answer 5.13</h2>
<p>1,find<span class="math inline">\(f_1\)</span></p>
<p>According to the structure of g(x),thus we choose the<span class="math inline">\(f_1(x)=kxe^{-\frac{x^2}{2}}\)</span>;then we caculate the value of k <span class="math display">\[
\begin{align}
\int_1^{+\infty}kx e^{-\frac{x^2}{2}}dx&amp;=k\int_1^{+\infty}x e^{-\frac{x^2}{2}}dx\\
&amp;=\frac{1}{2}k \int_1^{+\infty}e^{-\frac{x^2}{2}}dx^2\\
&amp;=\frac{1}{2}k \int_1^{+\infty}e^{-\frac{u}{2}}du(x^2=u)\\
&amp;=\frac{1}{2}k \frac{e^{-\frac{u}{2}}}{-\frac{1}{2}}|_1^{{+\infty}}\\
&amp;=k e^{-\frac{1}{2}}
\end{align}
\]</span> making <span class="math inline">\(k e^{-\frac{1}{2}}=1\)</span>,thus <span class="math inline">\(k=e^{\frac{1}{2}}\)</span></p>
<p>so<span class="math inline">\(f_1(x)=e^{\frac{1}{2}} x e^{-\frac{x^2}{2}},x&gt;1\)</span> it is a density function.</p>
<p>next step:we employ inverse transformation method to generate random number of <span class="math inline">\(X\sim f_1(x)\)</span></p>
<p>First:caculate distribution function of X</p>
<p><span class="math display">\[
\begin{align}
F_X(u)&amp;=\int_1^u e^{\frac{1}{2}} x e^{-\frac{x^2}{2}}dx\\
&amp;=\frac{1}{2}e^{\frac{1}{2}}\int_1^ue^{-\frac{x^2}{2}}dx^2\\
&amp;=\frac{1}{2}e^{\frac{1}{2}}\int_1^ue^{-\frac{t}{2}}dt(x^2=t)\\
&amp;=\frac{1}{2}e^{\frac{1}{2}}\frac{e^{-\frac{t}{2}}}{-\frac{1}{2}}|_1^{{u}}\\
&amp;=1-e^{\frac{1}{2}(1-u^2)}
\end{align}
\]</span> Second step: caculate inverse function of<span class="math inline">\(F_X(u)\)</span> <span class="math display">\[
\begin{align}
F_X(u)=1-e^{\frac{1}{2}(1-u^2)}&amp;\iff 1-F_X(u)=e^{\frac{1}{2}(1-u^2)}\\
&amp;\iff 1-u^2=2ln(1-F_X(u))\\
&amp;\iff u=\sqrt{1-2ln(1-F_X(u))}
\end{align}
\]</span> <span class="math inline">\(\therefore F_X^{-1}(u)=\sqrt{1-2ln(1-u)},\)</span> making<span class="math inline">\(U\sim u(0,1)\)</span>,then <span class="math inline">\(F_X^{-1}(U)=\sqrt{1-2ln(1-U)}=\sqrt{1-2ln(U)}\)</span> (noting:1-U has a similar distribution function with U).</p>
<p>so <span class="math display">\[
\begin{align}
&amp;\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}dx\\
&amp;=\int_1^{+\infty}\frac{g(x)}{f_1(x)} f_1(x)dx\\
&amp;=\int_1^{+\infty}\frac{1}{e^{\frac{1}{2}} \sqrt{2\pi}}x f_1(x)dx\\
&amp;=E\left(\frac{1}{e^{\frac{1}{2}} \sqrt{2\pi}}x\right)\\
&amp;=\frac{1}{e^{\frac{1}{2}} \sqrt{2\pi}}E(x)
\end{align}
\]</span> so the estimator of the integral is <span class="math inline">\(\frac{1}{e^{\frac{1}{2}} \sqrt{2\pi}}\frac{1}{n}\sum_{i=1}^n X_i,X_i=\sqrt{1-2ln(U)},U\sim u(0,1)\)</span></p>
<p>codes as follows</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb12-4"><a href="#cb12-4"></a>x_<span class="dv">1</span>&lt;-(<span class="dv">1-2</span><span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span><span class="fl">0.5</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>int_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="fl">0.5</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">mean</span>(x_<span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>var_int_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>n)<span class="op">*</span><span class="kw">var</span>(x_<span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>sd_int_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="fl">0.5</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>n))<span class="op">*</span><span class="kw">sd</span>(x_<span class="dv">1</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">round</span>(<span class="kw">print</span>(<span class="kw">c</span>(int_<span class="dv">1</span>,var_int_<span class="dv">1</span>,sd_int_<span class="dv">1</span>)),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 4.011669e-01 1.551789e-06 1.245708e-03</code></pre>
<pre><code>## [1] 0.40116691 0.00000155 0.00124571</code></pre>
<p>2,find<span class="math inline">\(f_2\)</span></p>
<p>According to the structure of g(x),thus we choose the<span class="math inline">\(f_2(x)=\frac{1}{x^2},x&gt;1\)</span></p>
<p><span class="math inline">\(\because\)</span> <span class="math display">\[\int_1^{+\infty}f_2(x)dx=1\]</span> <span class="math inline">\(\therefore\)</span> it is a density function</p>
<p>then we employ inverse transformation method to generate random number of <span class="math inline">\(X\sim f_2(x)\)</span></p>
<p>First step:caculate distribution function</p>
<p><span class="math display">\[
F_X(u)=\int_1^u f_2(x)dx=1-\frac{1}{u}
\]</span> Second step:caculate inverse function of<span class="math inline">\(F_2(X)\)</span> <span class="math display">\[
F_X(u)=1-\frac{1}{u}\iff u=\frac{1}{1-F_X(u)}
\]</span> <span class="math inline">\(\therefore F_X^{-1}(u)=\frac{1}{1-u}\)</span>,making <span class="math inline">\(U\sim u(0,1),\therefore F_X^{-1}(U)=\frac{1}{1-U}=\frac{1}{U}\)</span>(noting:1-U has a similar distribution function with U)</p>
<p><span class="math inline">\(\therefore\)</span> <span class="math display">\[
\begin{align}
\int_1^{+\infty}g(x)dx&amp;=\int_1^{+\infty}\frac{g(x)}{f_1(x)} f_1(x)dx\\
&amp;=E\left(\frac{x^4}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\right)
\end{align}
\]</span> <span class="math inline">\(\therefore\)</span> the estimator of the integral is<span class="math inline">\(\frac{1}{n}\sum_{i=1}^n \frac{X_i^4}{\sqrt{2\pi}} e^{-\frac{X_i^2}{2}},X_i=\frac{1}{U},U\sim u(0,1)\)</span></p>
<p>codes as follows</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>n&lt;-<span class="fl">1e4</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb15-4"><a href="#cb15-4"></a>x_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>u</span>
<span id="cb15-5"><a href="#cb15-5"></a>t&lt;-<span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb15-6"><a href="#cb15-6"></a>int_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">mean</span>(t)</span>
<span id="cb15-7"><a href="#cb15-7"></a>var_int_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">var</span>(t)<span class="op">/</span>n</span>
<span id="cb15-8"><a href="#cb15-8"></a>sd_int_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">sqrt</span>(var_int_<span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="kw">round</span>(<span class="kw">print</span>(<span class="kw">c</span>(int_<span class="dv">2</span>,var_int_<span class="dv">2</span>,sd_int_<span class="dv">2</span>)),<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 3.974045e-01 9.263035e-06 3.043523e-03</code></pre>
<pre><code>## [1] 0.39740448 0.00000926 0.00304352</code></pre>
<p>3,analyze<span class="math inline">\(f_1(x),f_2(x)\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>a&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>g&lt;-<span class="st"> </span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb18-3"><a href="#cb18-3"></a>f_<span class="dv">1</span>&lt;-<span class="st"> </span>a<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">exp</span>(a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb18-4"><a href="#cb18-4"></a>f_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>a<span class="op">^</span><span class="dv">2</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="kw">plot</span>(a,g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">1</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">lines</span>(a,f_<span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="kw">lines</span>(a,f_<span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>black line represents <span class="math inline">\(g(x)\)</span>;red line represents <span class="math inline">\(f_1(x)\)</span>;green line represents <span class="math inline">\(f_2(x)\)</span>.</p>
<p>According to the above picture,compared with<span class="math inline">\(f_2(x)\)</span>,<span class="math inline">\(f_1(x)\)</span> is more similar to<span class="math inline">\(g(x)\)</span>. Actually,we can know the fact by observing the structure of functions.So this is why the variance of <span class="math inline">\(f_1(x)\)</span> is more little than the variance of <span class="math inline">\(f_2(x)\)</span></p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[
\int_0^1 \frac{1}{1+x^2} e^{-x}dx=\sum_{i=0}^4 \int_{\frac{i}{5}}^{\frac{i+1}{5}} \frac{1}{1+x^2} e^{-x}dx
\]</span> <span class="math inline">\(for \forall i,making \int_{\frac{i}{5}}^{\frac{i+1}{5}} k_i e^{-x}dx=1\)</span></p>
<p>so</p>
<p><span class="math display">\[
k_i=\frac{1}{e^{-\frac{i}{5}}-e^{-\frac{i+1}{5}}}
\]</span> so,for<span class="math inline">\(\forall i=0,1,2,3,4;\)</span></p>
<p><span class="math display">\[
f_{X_i}(x)=\frac{1}{e^{-\frac{i}{5}}-e^{-\frac{i+1}{5}}} e^{-x} I[\frac{i}{5}&lt;x&lt;\frac{i+1}{5}]
\]</span> is a density function.</p>
<p>so, <span class="math display">\[
\begin{align}
\int_0^1 \frac{1}{1+x^2} e^{-x}dx&amp;=\sum_{i=0}^4 \int_{\frac{i}{5}}^{\frac{i+1}{5}} \frac{1}{1+x^2} e^{-x}dx\\
&amp;=\sum_{i=0}^4 \int_{\frac{i}{5}}^{\frac{i+1}{5}} \frac{e^{-\frac{i}{5}}-e^{-\frac{i+1}{5}}}{1+x^2} f_{X_i}(x)dx\\
&amp;=\sum_{i=0}^4 E\left(\frac{1}{1+X_i^2}\right)k_i^{-1}
\end{align}
\]</span> noting:<span class="math inline">\(X_i\sim f_{X_i}(x)\)</span></p>
<p>now we employ the inverse transformation method to generate random number of <span class="math inline">\(X_i\)</span>.</p>
<p><span class="math display">\[
F_{X_i}(u)=\int_{\frac{i}{5}}^u k_i e^{-x}dx=k_i(e^{-\frac{i}{5}}-e^{-u})
\]</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
F_{X_i}^{-1}(u)=-ln(e^{-\frac{i}{5}}-\frac{u}{k_i})
\]</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
X_i =-ln(e^{-\frac{i}{5}}-\frac{U}{k_i});U\sim u(0,1)
\]</span> making <span class="math inline">\(Y_i=\frac{1}{1+X_i^2};\theta=\int_0^1 \frac{1}{1+x^2} e^{-x}dx\)</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
\theta=\sum_{i=0}^4 E\left(Y_i\right)k_i^{-1}\\
\hat{\theta}=\sum_{i=0}^4 k_i^{-1} \frac{1}{n}\sum_{j=1}^n Y_{ij}\\
D(\hat{\theta})=\sum_{i=0}^4 k_i^{-2} \frac{1}{n} D(Y_{ij})
\]</span> coeds as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>m&lt;-<span class="dv">5</span>;n&lt;-<span class="fl">1e4</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>k&lt;-<span class="kw">numeric</span>(m);theta_i&lt;-<span class="kw">numeric</span>(m);var_i&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb19-3"><a href="#cb19-3"></a>y&lt;-x&lt;-<span class="kw">matrix</span>(<span class="kw">numeric</span>(<span class="dv">5</span><span class="op">*</span>n),<span class="dt">ncol=</span><span class="dv">5</span>,<span class="dt">nrow=</span>n)</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb19-7"><a href="#cb19-7"></a>  k[i<span class="op">+</span><span class="dv">1</span>]&lt;-(<span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(i<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>))<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a>  x[,i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span>u<span class="op">/</span>k[i<span class="op">+</span><span class="dv">1</span>])</span>
<span id="cb19-9"><a href="#cb19-9"></a>  y[,i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>x[,i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb19-10"><a href="#cb19-10"></a>  theta_i[i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">mean</span>(y[,i<span class="op">+</span><span class="dv">1</span>])<span class="op">/</span>k[i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb19-11"><a href="#cb19-11"></a>  var_i[i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="st"> </span><span class="kw">var</span>(y[,i<span class="op">+</span><span class="dv">1</span>])<span class="op">/</span>(n<span class="op">*</span>k[i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb19-12"><a href="#cb19-12"></a>}</span>
<span id="cb19-13"><a href="#cb19-13"></a>hat_theta&lt;-<span class="st"> </span><span class="kw">sum</span>(theta_i)</span>
<span id="cb19-14"><a href="#cb19-14"></a>var_hat_theta&lt;-<span class="kw">sum</span>(var_i)</span>
<span id="cb19-15"><a href="#cb19-15"></a>sd_hat_theta&lt;-<span class="kw">sqrt</span>(var_hat_theta)</span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">c</span>(hat_theta,var_hat_theta,sd_hat_theta),<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## [1] 0.52476634 0.00000001 0.00007952</code></pre>
<p>compared with the result of Example 5.10,there was a significant reduction in variance.</p>
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that X1,,Xn are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter . Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\because\)</span> X1,,Xn are a random sample from a from a lognormal distribution with unknown parameters.<span class="math inline">\(\therefore\)</span> making <span class="math inline">\(Y_i=ln\left(X_i\right)\)</span>,thus <span class="math inline">\(Y_i\overset{iid}{\sim}N\left(\mu,\sigma^2\right)\)</span>.</p>
<p><span class="math inline">\(\because\)</span> there are unknown parameters,<span class="math inline">\(therefore\)</span> there are two cases as follows:</p>
<p>First case:when there is a more smaller sample size,we employ t distribution to solve the problem.</p>
<p>Second case:when there is a more bigger sample size,we employ normal distribution to solve the problem.</p>
<p>According to several knowledge of statistics,there are some facts as follows:</p>
<p><span class="math display">\[
\frac{\bar{Y_i}-\mu}{\sqrt{\frac{\sigma^2}{n}}}\sim N(0,1)
\]</span> <span class="math display">\[
\frac{(n-1)s^2}{\sigma^2}\sim \chi^2 (n-1);S=\sqrt{S^2}=\sqrt{\frac{\sum_{i=1}^n(Y_i-\bar{Y})}{n-1}}
\]</span> so</p>
<p><span class="math display">\[
\frac{\sqrt{n}(\bar{Y_i}-\mu)}{S}\sim t(n-1)
\]</span> <span class="math display">\[
\frac{\sqrt{n}(\bar{Y_i}-\mu)}{S}\sim N(0,1)(n\rightarrow +\infty)
\]</span> so,the confidence interval is</p>
<p>First case: <span class="math display">\[
\left(\bar{Y_i}-\frac{S* t_{\frac{\alpha}{2}}(n-1)}{\sqrt{n}},\bar{Y_i}+\frac{S* t_{\frac{\alpha}{2}}(n-1)}{\sqrt{n}}\right)
\]</span></p>
<p>Second case: <span class="math display">\[
\left(\bar{Y_i}-\frac{S* Z_{\frac{\alpha}{2}}}{\sqrt{n}},\bar{Y_i}+\frac{S* Z_{\frac{\alpha}{2}}}{\sqrt{n}}\right)(n\rightarrow +\infty)
\]</span> codes as follows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>mu&lt;-<span class="dv">0</span>;sigma&lt;-<span class="dv">1</span>;m&lt;-<span class="fl">1e4</span>;n1&lt;-<span class="dv">10</span>;n2&lt;-<span class="dv">100</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>y_<span class="dv">1</span>&lt;-<span class="kw">numeric</span>(m);y_<span class="dv">2</span>&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb21-3"><a href="#cb21-3"></a>sd_<span class="dv">1</span>&lt;-<span class="kw">numeric</span>(m);sd_<span class="dv">2</span>&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb21-4"><a href="#cb21-4"></a>t_<span class="fl">0.025</span>_<span class="dv">9</span>&lt;-<span class="fl">2.262</span>;z_<span class="fl">0.025</span>&lt;-<span class="fl">1.96</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co"># first case:t distribution</span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb21-7"><a href="#cb21-7"></a>  a&lt;-<span class="kw">rt</span>(n1,n1<span class="dv">-1</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>  y_<span class="dv">1</span>[i]&lt;-<span class="kw">mean</span>(a)</span>
<span id="cb21-9"><a href="#cb21-9"></a>  sd_<span class="dv">1</span>[i]&lt;-<span class="kw">sd</span>(a)</span>
<span id="cb21-10"><a href="#cb21-10"></a>}</span>
<span id="cb21-11"><a href="#cb21-11"></a>t_theta_<span class="dv">1</span>&lt;-<span class="st"> </span>y_<span class="dv">1</span><span class="op">-</span>sd_<span class="dv">1</span><span class="op">*</span>t_<span class="fl">0.025</span>_<span class="dv">9</span><span class="op">/</span><span class="kw">sqrt</span>(n1)</span>
<span id="cb21-12"><a href="#cb21-12"></a>t_theta_<span class="dv">2</span>&lt;-<span class="st"> </span>y_<span class="dv">1</span><span class="op">+</span>sd_<span class="dv">1</span><span class="op">*</span>t_<span class="fl">0.025</span>_<span class="dv">9</span><span class="op">/</span><span class="kw">sqrt</span>(n1)</span>
<span id="cb21-13"><a href="#cb21-13"></a>d1&lt;-<span class="dv">0</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="cf">if</span>(t_theta_<span class="dv">1</span>[i]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>mu<span class="op">&lt;=</span>t_theta_<span class="dv">2</span>[i]){</span>
<span id="cb21-16"><a href="#cb21-16"></a>    d1&lt;-<span class="st"> </span>d1<span class="op">+</span><span class="dv">1</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>  }</span>
<span id="cb21-18"><a href="#cb21-18"></a>}</span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(t_theta_<span class="dv">1</span>),<span class="kw">mean</span>(t_theta_<span class="dv">2</span>))) <span class="co">#confidence interval</span></span></code></pre></div>
<pre><code>## [1] -0.7806124  0.7760975</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">print</span>(d1<span class="op">/</span>m) <span class="co">#empirical coverage probability</span></span></code></pre></div>
<pre><code>## [1] 0.9527</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># second case:normal distribution</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-3"><a href="#cb25-3"></a>  b&lt;-<span class="kw">rnorm</span>(n2)</span>
<span id="cb25-4"><a href="#cb25-4"></a>  y_<span class="dv">2</span>[i]&lt;-<span class="kw">mean</span>(b)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  sd_<span class="dv">2</span>[i]&lt;-<span class="kw">sd</span>(b)</span>
<span id="cb25-6"><a href="#cb25-6"></a>}</span>
<span id="cb25-7"><a href="#cb25-7"></a>n_theta_<span class="dv">1</span>&lt;-y_<span class="dv">2</span><span class="op">-</span>sd_<span class="dv">2</span><span class="op">*</span>z_<span class="fl">0.025</span><span class="op">/</span><span class="kw">sqrt</span>(n2)</span>
<span id="cb25-8"><a href="#cb25-8"></a>n_theta_<span class="dv">2</span>&lt;-y_<span class="dv">2</span><span class="op">+</span>sd_<span class="dv">2</span><span class="op">*</span>z_<span class="fl">0.025</span><span class="op">/</span><span class="kw">sqrt</span>(n2)</span>
<span id="cb25-9"><a href="#cb25-9"></a>d2&lt;-<span class="dv">0</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="cf">if</span>(n_theta_<span class="dv">1</span>[i]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>mu<span class="op">&lt;=</span>n_theta_<span class="dv">2</span>[i]){</span>
<span id="cb25-12"><a href="#cb25-12"></a>    d2&lt;-<span class="st"> </span>d2<span class="op">+</span><span class="dv">1</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>  }</span>
<span id="cb25-14"><a href="#cb25-14"></a>}</span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(n_theta_<span class="dv">1</span>),<span class="kw">mean</span>(n_theta_<span class="dv">2</span>))) <span class="co">#confidence interval</span></span></code></pre></div>
<pre><code>## [1] -0.1951715  0.1960092</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">print</span>(d2<span class="op">/</span>m) <span class="co">#empirical coverage probability</span></span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<p>the ECP(empirical coverage probability) of first case is taller than 0.95;the ECP(empirical coverage probability) of second case is lower than 0.95.because second case is a Approximate distribution,first case is a Precise distribution.so using t distribution with samller sample size is more efficient than using normal distribution with bigger sample size.</p>
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of 2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>According to several knowledge of statistics,a 95% symmetric t-interval applied to estimate a mean from normal distribution is <span class="math display">\[
\left(\bar{Y_i}-\frac{S* t_{\frac{\alpha}{2}}(n-1)}{\sqrt{n}},\bar{Y_i}+\frac{S* t_{\frac{\alpha}{2}}(n-1)}{\sqrt{n}}\right)
\]</span> noting: <span class="math display">\[
\bar{Y_i}=\frac{1}{n}\sum_{i=1}^n Y_i;S=\sqrt{S^2}=\sqrt{\frac{\sum_{i=1}^n(Y_i-\bar{Y})}{n-1}}
\]</span> then we keep the format of this confidence interval,making <span class="math inline">\(Y_i\overset{iid}{\sim}\chi^2(2);E(Y_i)=2\)</span></p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>m&lt;-<span class="st"> </span><span class="fl">1e4</span>;n&lt;-<span class="dv">20</span>;sd&lt;-<span class="kw">numeric</span>(m);y&lt;-<span class="kw">numeric</span>(m);t_<span class="fl">0.025</span>_<span class="dv">19</span>&lt;-<span class="st"> </span><span class="fl">2.093</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb29-3"><a href="#cb29-3"></a>  a&lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a>  y[i]&lt;-<span class="st"> </span><span class="kw">mean</span>(a)</span>
<span id="cb29-5"><a href="#cb29-5"></a>  sd[i]&lt;-<span class="st"> </span><span class="kw">sd</span>(a)</span>
<span id="cb29-6"><a href="#cb29-6"></a>}</span>
<span id="cb29-7"><a href="#cb29-7"></a>theta_<span class="dv">1</span>&lt;-<span class="st"> </span>y<span class="op">-</span>sd<span class="op">*</span>t_<span class="fl">0.025</span>_<span class="dv">19</span><span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb29-8"><a href="#cb29-8"></a>theta_<span class="dv">2</span>&lt;-<span class="st"> </span>y<span class="op">+</span>sd<span class="op">*</span>t_<span class="fl">0.025</span>_<span class="dv">19</span><span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb29-9"><a href="#cb29-9"></a>d&lt;-<span class="dv">0</span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="cf">if</span>(theta_<span class="dv">1</span>[i]<span class="op">&lt;=</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span><span class="dv">2</span><span class="op">&lt;=</span>theta_<span class="dv">2</span>[i]){</span>
<span id="cb29-12"><a href="#cb29-12"></a>    d&lt;-<span class="st"> </span>d<span class="op">+</span><span class="dv">1</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>  }</span>
<span id="cb29-14"><a href="#cb29-14"></a>}<span class="co"># the mean of chis-quared is 2</span></span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="kw">print</span>(d<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 0.9164</code></pre>
<p>compared with simulation results in Example 6.4.The t-interval should be more robust to departures from normality than the interval for variance.</p>
</div>
<div id="question-6.7" class="section level2">
<h2>Question 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t()?</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>we put the results of skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\alpha\)</span>) distributions and the results of skewness test of normality against t() together.</p>
<p>before simulation,we guess that both results are poor,because If the distribution of X is normal, then <span class="math inline">\(\sqrt{b_1}\)</span> is asymptotically normal with mean 0 and variance 6/n(or 6(n-2)/(n+1)*(n+3)). <span class="math display">\[
\sqrt{b_1}=\frac{\frac{1}{n}\sum_{i=1}^n (X_i -\bar{X})^3}{(\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2)^{\frac{3}{2}}}
\]</span> but both distributions in this exercise are not normal distribution.</p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>alpha&lt;-<span class="fl">0.05</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>m&lt;-<span class="fl">1e4</span> </span>
<span id="cb31-3"><a href="#cb31-3"></a>a&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">241</span>,<span class="dv">4</span>) </span>
<span id="cb31-4"><a href="#cb31-4"></a>n&lt;-<span class="kw">length</span>(a)</span>
<span id="cb31-5"><a href="#cb31-5"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>)))) </span>
<span id="cb31-6"><a href="#cb31-6"></a>eop&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(a)) </span>
<span id="cb31-7"><a href="#cb31-7"></a>eop1&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(a))</span>
<span id="cb31-8"><a href="#cb31-8"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb31-11"><a href="#cb31-11"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-13"><a href="#cb31-13"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb31-14"><a href="#cb31-14"></a>}</span>
<span id="cb31-15"><a href="#cb31-15"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb31-16"><a href="#cb31-16"></a>  sr&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb31-17"><a href="#cb31-17"></a>  sr1&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb31-19"><a href="#cb31-19"></a>    x&lt;-<span class="kw">rbeta</span>(n,a[j],a[j])</span>
<span id="cb31-20"><a href="#cb31-20"></a>    x1&lt;-<span class="kw">rt</span>(n,a[j])</span>
<span id="cb31-21"><a href="#cb31-21"></a>    sr[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;</span><span class="st"> </span>cv)</span>
<span id="cb31-22"><a href="#cb31-22"></a>    sr1[i]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x1))<span class="op">&gt;</span>cv)</span>
<span id="cb31-23"><a href="#cb31-23"></a>  }</span>
<span id="cb31-24"><a href="#cb31-24"></a>  eop[j]&lt;-<span class="kw">mean</span>(sr)</span>
<span id="cb31-25"><a href="#cb31-25"></a>  eop1[j]&lt;-<span class="kw">mean</span>(sr1)</span>
<span id="cb31-26"><a href="#cb31-26"></a>}</span>
<span id="cb31-27"><a href="#cb31-27"></a>eop</span></code></pre></div>
<pre><code>##  [1] 0.0022 0.0101 0.0206 0.0293 0.0329 0.0383 0.0373 0.0386 0.0403 0.0428
## [11] 0.0422 0.0454 0.0438 0.0452 0.0457 0.0492 0.0472 0.0447 0.0461 0.0443
## [21] 0.0490 0.0496 0.0538 0.0447 0.0467 0.0448 0.0486 0.0496 0.0498 0.0472
## [31] 0.0474 0.0487 0.0490 0.0513 0.0483 0.0495 0.0489 0.0451 0.0473 0.0483
## [41] 0.0484 0.0506 0.0468 0.0528 0.0466 0.0504 0.0524 0.0496 0.0471 0.0513
## [51] 0.0509 0.0491 0.0485 0.0520 0.0507 0.0489 0.0499 0.0452 0.0511 0.0476
## [61] 0.0475</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>eop1</span></code></pre></div>
<pre><code>##  [1] 0.9243 0.3432 0.1965 0.1391 0.1114 0.1038 0.0857 0.0815 0.0820 0.0786
## [11] 0.0755 0.0736 0.0680 0.0709 0.0712 0.0657 0.0701 0.0624 0.0618 0.0627
## [21] 0.0619 0.0604 0.0591 0.0608 0.0622 0.0579 0.0602 0.0577 0.0572 0.0593
## [31] 0.0564 0.0587 0.0567 0.0588 0.0574 0.0580 0.0572 0.0575 0.0551 0.0576
## [41] 0.0585 0.0545 0.0584 0.0575 0.0569 0.0551 0.0517 0.0570 0.0577 0.0540
## [51] 0.0562 0.0556 0.0575 0.0542 0.0543 0.0540 0.0546 0.0561 0.0574 0.0600
## [61] 0.0548</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">plot</span>(a, eop, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">points</span>(a,eop1,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">lines</span>(eop,<span class="dt">col=</span><span class="st">&quot;DarkTurquoise&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw">lines</span>(eop1,<span class="dt">col=</span><span class="st">&quot;DeepPink&quot;</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw">print</span>(d&lt;-<span class="kw">data.frame</span>(eop,eop1))</span></code></pre></div>
<pre><code>##       eop   eop1
## 1  0.0022 0.9243
## 2  0.0101 0.3432
## 3  0.0206 0.1965
## 4  0.0293 0.1391
## 5  0.0329 0.1114
## 6  0.0383 0.1038
## 7  0.0373 0.0857
## 8  0.0386 0.0815
## 9  0.0403 0.0820
## 10 0.0428 0.0786
## 11 0.0422 0.0755
## 12 0.0454 0.0736
## 13 0.0438 0.0680
## 14 0.0452 0.0709
## 15 0.0457 0.0712
## 16 0.0492 0.0657
## 17 0.0472 0.0701
## 18 0.0447 0.0624
## 19 0.0461 0.0618
## 20 0.0443 0.0627
## 21 0.0490 0.0619
## 22 0.0496 0.0604
## 23 0.0538 0.0591
## 24 0.0447 0.0608
## 25 0.0467 0.0622
## 26 0.0448 0.0579
## 27 0.0486 0.0602
## 28 0.0496 0.0577
## 29 0.0498 0.0572
## 30 0.0472 0.0593
## 31 0.0474 0.0564
## 32 0.0487 0.0587
## 33 0.0490 0.0567
## 34 0.0513 0.0588
## 35 0.0483 0.0574
## 36 0.0495 0.0580
## 37 0.0489 0.0572
## 38 0.0451 0.0575
## 39 0.0473 0.0551
## 40 0.0483 0.0576
## 41 0.0484 0.0585
## 42 0.0506 0.0545
## 43 0.0468 0.0584
## 44 0.0528 0.0575
## 45 0.0466 0.0569
## 46 0.0504 0.0551
## 47 0.0524 0.0517
## 48 0.0496 0.0570
## 49 0.0471 0.0577
## 50 0.0513 0.0540
## 51 0.0509 0.0562
## 52 0.0491 0.0556
## 53 0.0485 0.0575
## 54 0.0520 0.0542
## 55 0.0507 0.0543
## 56 0.0489 0.0540
## 57 0.0499 0.0546
## 58 0.0452 0.0561
## 59 0.0511 0.0574
## 60 0.0476 0.0600
## 61 0.0475 0.0548</code></pre>
<p>according to the results above,we learn two facts as follows</p>
<p>first:the results accord with our prediction before simulation;in other words,they are poor.</p>
<p>second:when parameters are samll,compared with results of t(v),the results of symmetric Beta(<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\alpha\)</span>) distributions are significantly different.when parameters are large enough,they are very similar.</p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\)</span> = 0.055. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>As for small sample size,we sampled 20 samples;As for medium sample size,we sampled 35 samples;As for large sample size,we sampled 60 samples.</p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb38-2"><a href="#cb38-2"></a>  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb38-3"><a href="#cb38-3"></a>  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb38-4"><a href="#cb38-4"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb38-5"><a href="#cb38-5"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb38-6"><a href="#cb38-6"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb38-8"><a href="#cb38-8"></a>}</span>
<span id="cb38-9"><a href="#cb38-9"></a>m&lt;-<span class="fl">1e4</span></span>
<span id="cb38-10"><a href="#cb38-10"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb38-11"><a href="#cb38-11"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb38-12"><a href="#cb38-12"></a>n&lt;-<span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">35</span>,<span class="dv">60</span>) </span>
<span id="cb38-13"><a href="#cb38-13"></a>power&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n));power_f&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb38-15"><a href="#cb38-15"></a>  power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb38-16"><a href="#cb38-16"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb38-17"><a href="#cb38-17"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb38-18"><a href="#cb38-18"></a>    <span class="kw">count5test</span>(x, y)</span>
<span id="cb38-19"><a href="#cb38-19"></a>  }))<span class="co"># power of  count five test</span></span>
<span id="cb38-20"><a href="#cb38-20"></a>  pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb38-21"><a href="#cb38-21"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb38-22"><a href="#cb38-22"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb38-23"><a href="#cb38-23"></a>    ftest &lt;-<span class="st"> </span><span class="kw">var.test</span>(x,y)</span>
<span id="cb38-24"><a href="#cb38-24"></a>    ftest<span class="op">$</span>p.value } )</span>
<span id="cb38-25"><a href="#cb38-25"></a>  power_f[i]&lt;-<span class="kw">mean</span>(pvalues<span class="op">&lt;=</span><span class="fl">0.055</span>)<span class="co"># power of f test</span></span>
<span id="cb38-26"><a href="#cb38-26"></a>}</span>
<span id="cb38-27"><a href="#cb38-27"></a>k&lt;-<span class="kw">data.frame</span>(power,power_f,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;small sample 20&quot;</span>,<span class="st">&quot;medium sample 35&quot;</span>,<span class="st">&quot;big sample 60&quot;</span>))</span>
<span id="cb38-28"><a href="#cb38-28"></a><span class="kw">print</span>(k)</span></code></pre></div>
<pre><code>##                   power power_f
## small sample 20  0.3154  0.4132
## medium sample 35 0.5309  0.6536
## big sample 60    0.7144  0.8789</code></pre>
<p>According to the results above, no matter how big the sample size is,the power of F test is higher than the power of count five test.</p>
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardias multivariate skewness test. Mardia proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1,d}=E\left[(X-\mu)^T \Sigma^{-1}(Y-\mu)\right]^3
\]</span> Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n \left[(X_i-\bar{X})^T \hat{\Sigma}^{-1}(X_j-\bar{X})\right]^3
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(\hat{b_{1,d}}\)</span>are significant. The asymptotic distribution of nb1,d/6 is chisquared with d(d + 1)(d + 2)/6 degrees of freedom.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>first of all,for more convenient solve the problems of example 6.8 and example 6.10,we should create a function to compute the value of multivariate skewness statistics <span class="math inline">\(b_{1,d}\)</span> <span class="math display">\[
b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n \left[(X_i-\bar{X})^T \hat{\Sigma}^{-1}(X_j-\bar{X})\right]^3
\]</span> codes as follows:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>cs&lt;-<span class="cf">function</span>(data.frame){</span>
<span id="cb40-2"><a href="#cb40-2"></a>  xbar&lt;-<span class="kw">numeric</span>()</span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(data.frame)){</span>
<span id="cb40-4"><a href="#cb40-4"></a>    xbar[k]&lt;-<span class="kw">mean</span>(data.frame[,k])</span>
<span id="cb40-5"><a href="#cb40-5"></a>  }</span>
<span id="cb40-6"><a href="#cb40-6"></a>  isum&lt;-<span class="kw">numeric</span>()</span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data.frame)){</span>
<span id="cb40-8"><a href="#cb40-8"></a>    jsum&lt;-<span class="kw">numeric</span>()</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(data.frame)){</span>
<span id="cb40-10"><a href="#cb40-10"></a>      jsum[j]&lt;-(<span class="kw">as.matrix</span>(data.frame[i,])<span class="op">%*%</span><span class="kw">solve</span>(<span class="kw">cov</span>(data.frame))<span class="op">%*%</span><span class="kw">as.matrix</span>(<span class="kw">t</span>(data.frame[j,])))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb40-11"><a href="#cb40-11"></a>    }</span>
<span id="cb40-12"><a href="#cb40-12"></a>    isum[i]&lt;-<span class="kw">sum</span>(jsum)</span>
<span id="cb40-13"><a href="#cb40-13"></a>  }</span>
<span id="cb40-14"><a href="#cb40-14"></a>  b&lt;-<span class="kw">sum</span>(isum)<span class="op">/</span><span class="kw">nrow</span>(data.frame)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>  <span class="kw">return</span>(b)</span>
<span id="cb40-16"><a href="#cb40-16"></a>}</span></code></pre></div>
<p>example 6.8 for multivariate</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">#example 6.8 for multivariate</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>n&lt;-<span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">50</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a>alpha&lt;-<span class="fl">0.05</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>d&lt;-<span class="dv">3</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>m&lt;-<span class="dv">100</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>cv&lt;-<span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>p_reject&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb41-9"><a href="#cb41-9"></a>  tr&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb41-10"><a href="#cb41-10"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb41-11"><a href="#cb41-11"></a>    x1&lt;-<span class="kw">rnorm</span>(n[i])</span>
<span id="cb41-12"><a href="#cb41-12"></a>    x2&lt;-<span class="kw">rnorm</span>(n[i])</span>
<span id="cb41-13"><a href="#cb41-13"></a>    x3&lt;-<span class="kw">rnorm</span>(n[i])</span>
<span id="cb41-14"><a href="#cb41-14"></a>    s&lt;-<span class="kw">data.frame</span>(x1,x2,x3)</span>
<span id="cb41-15"><a href="#cb41-15"></a>    tr[j]&lt;-<span class="kw">as.integer</span>(n[i]<span class="op">*</span><span class="kw">cs</span>(s)<span class="op">/</span><span class="dv">6</span><span class="op">&gt;=</span>cv)</span>
<span id="cb41-16"><a href="#cb41-16"></a>  }</span>
<span id="cb41-17"><a href="#cb41-17"></a>  p_reject[i]&lt;-<span class="kw">mean</span>(tr)</span>
<span id="cb41-18"><a href="#cb41-18"></a>}</span>
<span id="cb41-19"><a href="#cb41-19"></a><span class="kw">print</span>(p_reject)</span></code></pre></div>
<pre><code>## [1] 0.37 0.31</code></pre>
<p>According to the results above,there are not enough reasons to reject the null hypothesis(skewness is 0).</p>
<p>example 6.10 for multivariate</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">#example 6.10 for multivriate</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.75</span>)</span>
<span id="cb43-3"><a href="#cb43-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb43-5"><a href="#cb43-5"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>d&lt;-<span class="dv">3</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>pw&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(epsilon))</span>
<span id="cb43-8"><a href="#cb43-8"></a>cv&lt;-<span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(epsilon)){</span>
<span id="cb43-10"><a href="#cb43-10"></a>  tr&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb43-11"><a href="#cb43-11"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb43-12"><a href="#cb43-12"></a>    sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb43-13"><a href="#cb43-13"></a>                    <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>epsilon[i], epsilon[i]))</span>
<span id="cb43-14"><a href="#cb43-14"></a>    x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb43-15"><a href="#cb43-15"></a>    x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb43-16"><a href="#cb43-16"></a>    x3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb43-17"><a href="#cb43-17"></a>    s&lt;-<span class="kw">data.frame</span>(x1,x2,x3)</span>
<span id="cb43-18"><a href="#cb43-18"></a>    tr[j]&lt;-<span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">cs</span>(s)<span class="op">/</span><span class="dv">6</span><span class="op">&gt;=</span>cv)</span>
<span id="cb43-19"><a href="#cb43-19"></a>  }</span>
<span id="cb43-20"><a href="#cb43-20"></a>  pw[i]&lt;-<span class="kw">mean</span>(tr)</span>
<span id="cb43-21"><a href="#cb43-21"></a>}</span>
<span id="cb43-22"><a href="#cb43-22"></a><span class="kw">print</span>(pw)</span></code></pre></div>
<pre><code>## [1] 0.95 0.68</code></pre>
<p>according to the results above,there is a better result when <span class="math inline">\(\epsilon=0.5\)</span>.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>1,If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>Answer1</p>
<p>we cannot say the power are different at 0.05 level.</p>
<p>2,What is the corresponding hypothesis test problem?</p>
<p>Answer2</p>
<p>the problem maybe there is too small sample size.</p>
<p>3,What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>Answer3</p>
<p>except two-sample t-test,we can employ the others.because the precondition of using two-sample t-test is there are two independent samples.</p>
<p>4,What information is needed to test your hypothesis?</p>
<p>Answer4</p>
<p>adequate samples;better characteristic statistics.</p>
</div>
<div id="question-7.1" class="section level2">
<h2>Question 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[
\hat{bias_{jack}}=(n-1)\left(\bar{\theta_{(.)}}-\hat{\theta}\right)
\]</span> <span class="math display">\[
\hat{se_{jack}}=\sqrt{(n-1)\frac{1}{n}\sum_{i=1}^n (\hat{\theta_{(i)}}-\bar{\theta_{(.)}})}
\]</span> <span class="math inline">\(\hat{\theta}\)</span> is an estimator from original sample</p>
<p><span class="math inline">\(\hat{\theta_{(i)}}\)</span> is the ith estimator of the ith jackknife sample</p>
<p><span class="math display">\[\bar{\theta_{(.)}}=\frac{1}{n}\sum_{i=1}^n \hat{\theta_{(i)}}\]</span> codes as follows:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">#jackknife estimate of the bias of the correlation statistic in Example 7.2.</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>LSAT&lt;-<span class="kw">c</span>(<span class="dv">576</span>, <span class="dv">635</span>, <span class="dv">558</span>, <span class="dv">578</span>, <span class="dv">666</span>, <span class="dv">580</span>, <span class="dv">555</span>, <span class="dv">661</span>, <span class="dv">651</span>, <span class="dv">605</span>, <span class="dv">653</span>, <span class="dv">575</span>, <span class="dv">545</span>, <span class="dv">572</span>, <span class="dv">594</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>GPA&lt;-<span class="kw">c</span>(<span class="dv">339</span>, <span class="dv">330</span>, <span class="dv">281</span>, <span class="dv">303</span>, <span class="dv">344</span>, <span class="dv">307</span>, <span class="dv">300</span>, <span class="dv">343</span>, <span class="dv">336</span>, <span class="dv">313</span>, <span class="dv">312</span>, <span class="dv">274</span>, <span class="dv">276</span>, <span class="dv">288</span>, <span class="dv">296</span>)</span>
<span id="cb45-4"><a href="#cb45-4"></a>cor_jack&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(LSAT))<span class="co">#generate a container of values</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(LSAT)){</span>
<span id="cb45-6"><a href="#cb45-6"></a>  cor_jack[i]&lt;-<span class="kw">cor</span>(LSAT[<span class="op">-</span>i],GPA[<span class="op">-</span>i])</span>
<span id="cb45-7"><a href="#cb45-7"></a>}<span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>bais_jack&lt;-(<span class="kw">length</span>(LSAT)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(cor_jack)<span class="op">-</span><span class="kw">cor</span>(LSAT,GPA))</span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="kw">print</span>(bais_jack)</span></code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">#jackknife estimate of the standard error of the correlation statistic in Example 7.2.</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((<span class="kw">length</span>(LSAT)<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="kw">mean</span>((cor_jack<span class="op">-</span><span class="kw">mean</span>(cor_jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="kw">print</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>codes as follows:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb49-2"><a href="#cb49-2"></a>time&lt;-<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a>boot_obj_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">boot</span>(time, <span class="dt">R =</span> <span class="dv">2000</span>,</span>
<span id="cb49-4"><a href="#cb49-4"></a>                 <span class="dt">statistic =</span> <span class="cf">function</span>(x, i){<span class="kw">return</span>(<span class="kw">mean</span>(x[i]))})</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot_obj_<span class="dv">1</span>, <span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_obj_1, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.9, 183.3 )   ( 24.3, 168.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 191.9 )   ( 58.6, 233.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>According to the results above,it is Obvious that there are different results from different methods.The standard bootstrap confidence interval based on asymptotic normality;The basic bootstrap confidence intervals based on the large sample property;Percentile CI (percent) by assuming <span class="math inline">\(\hat{\theta*}\)</span> and <span class="math inline">\(\hat{\theta}\)</span> have approximately the same distribution;Better bootstrap confidence intervals are a modified version of percentile intervals,with Adjustments to percentile.this is why their results are different.</p>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[
\hat{bias_{jack}}=(n-1)\left(\bar{\theta_{(.)}}-\hat{\theta}\right)
\]</span></p>
<p><span class="math display">\[
\hat{se_{jack}}=\sqrt{(n-1)\frac{1}{n}\sum_{i=1}^n (\hat{\theta_{(i)}}-\bar{\theta_{(.)}})}
\]</span> <span class="math inline">\(\hat{\theta}\)</span> is an estimator from original sample</p>
<p><span class="math inline">\(\hat{\theta_{(i)}}\)</span> is the ith estimator of the ith jackknife sample</p>
<p><span class="math display">\[\bar{\theta_{(.)}}=\frac{1}{n}\sum_{i=1}^n \hat{\theta_{(i)}}\]</span></p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: &#39;bootstrap&#39;R4.0.3 </code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">data</span>(scor, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb53-2"><a href="#cb53-2"></a>a&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(scor))</span>
<span id="cb53-3"><a href="#cb53-3"></a>ht&lt;-a<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(a<span class="op">$</span>values)</span>
<span id="cb53-4"><a href="#cb53-4"></a>ht_jack&lt;-<span class="kw">numeric</span>(<span class="kw">nrow</span>(scor))</span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(scor)){</span>
<span id="cb53-6"><a href="#cb53-6"></a>  ht_jack[i]&lt;-<span class="kw">eigen</span>(<span class="kw">cov</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values)</span>
<span id="cb53-7"><a href="#cb53-7"></a>}</span>
<span id="cb53-8"><a href="#cb53-8"></a>bias_jack&lt;-(<span class="kw">nrow</span>(scor)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(ht_jack)<span class="op">-</span>ht)</span>
<span id="cb53-9"><a href="#cb53-9"></a>se_jack&lt;-<span class="kw">sqrt</span>((<span class="kw">nrow</span>(scor)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((ht_jack<span class="op">-</span><span class="kw">mean</span>(ht_jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="kw">print</span>(<span class="kw">c</span>(bias_jack,se_jack))</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
<div id="question-7.11" class="section level2">
<h2>Question 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>in analogy with leave-one-out (n-fold) cross validation,as for leave-two-out cross validation,we set some settings as follows.</p>
<p>there are <span class="math inline">\(C_n^2\)</span> kinds of methods to choose two samples as test points;hence,we stipulate the test points from original samples are (n,1), (k,k+1),k=1,2.n-1,noting: (k,k+1) denotes setting the kth and the (k+1)th as test points.And the prediction error <span class="math inline">\(e_k=|y_k-\hat{y_k}|+|y_{k+1}-\hat{y_{k+1}}|\)</span> and <span class="math inline">\(e=\frac{1}{n}\sum_{k=1}^n e_k^2\)</span></p>
<p>coeds as follows:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">library</span>(<span class="st">&quot;DAAG&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: &#39;DAAG&#39;R4.0.3 </code></pre>
<pre><code>## lattice</code></pre>
<pre><code>## 
## &#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="kw">data</span>(ironslag,<span class="dt">package=</span><span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb60-2"><a href="#cb60-2"></a>magnetic&lt;-ironslag<span class="op">$</span>magnetic</span>
<span id="cb60-3"><a href="#cb60-3"></a>chemical&lt;-ironslag<span class="op">$</span>chemical</span>
<span id="cb60-4"><a href="#cb60-4"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb60-7"><a href="#cb60-7"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n<span class="dv">-1</span>) {</span>
<span id="cb60-8"><a href="#cb60-8"></a>  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb60-9"><a href="#cb60-9"></a>  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb60-10"><a href="#cb60-10"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb60-11"><a href="#cb60-11"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb60-12"><a href="#cb60-12"></a>  e1[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[k<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>yhat1[<span class="dv">2</span>])</span>
<span id="cb60-13"><a href="#cb60-13"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb60-14"><a href="#cb60-14"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)] <span class="op">+</span></span>
<span id="cb60-15"><a href="#cb60-15"></a><span class="st">    </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-16"><a href="#cb60-16"></a>  e2[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[k<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>yhat1[<span class="dv">2</span>])</span>
<span id="cb60-17"><a href="#cb60-17"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb60-18"><a href="#cb60-18"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb60-19"><a href="#cb60-19"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb60-20"><a href="#cb60-20"></a>  e3[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[k<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>yhat1[<span class="dv">2</span>])</span>
<span id="cb60-21"><a href="#cb60-21"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb60-22"><a href="#cb60-22"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(k,k<span class="op">+</span><span class="dv">1</span>)])</span>
<span id="cb60-23"><a href="#cb60-23"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb60-24"><a href="#cb60-24"></a>  e4[k] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[k<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>yhat1[<span class="dv">2</span>])</span>
<span id="cb60-25"><a href="#cb60-25"></a>}</span>
<span id="cb60-26"><a href="#cb60-26"></a>y_<span class="dv">1</span>&lt;-magnetic[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,n)]</span>
<span id="cb60-27"><a href="#cb60-27"></a>x_<span class="dv">1</span>&lt;-chemical[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,n)]</span>
<span id="cb60-28"><a href="#cb60-28"></a>J1_<span class="dv">1</span>&lt;-<span class="kw">lm</span>(y_<span class="dv">1</span><span class="op">~</span>x_<span class="dv">1</span>)</span>
<span id="cb60-29"><a href="#cb60-29"></a>yhat1_<span class="dv">1</span>&lt;-J1_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(<span class="dv">1</span>,n)]</span>
<span id="cb60-30"><a href="#cb60-30"></a>e1[n]&lt;-<span class="kw">abs</span>(magnetic[<span class="dv">1</span>]<span class="op">-</span>yhat1_<span class="dv">1</span>[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[n]<span class="op">-</span>yhat1_<span class="dv">1</span>[<span class="dv">2</span>])</span>
<span id="cb60-31"><a href="#cb60-31"></a>J2_<span class="dv">1</span>&lt;-<span class="kw">lm</span>(y_<span class="dv">1</span><span class="op">~</span>x_<span class="dv">1</span><span class="op">+</span><span class="kw">I</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb60-32"><a href="#cb60-32"></a>yhat2_<span class="dv">1</span>&lt;-J2_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(<span class="dv">1</span>,n)] <span class="op">+</span></span>
<span id="cb60-33"><a href="#cb60-33"></a><span class="st">  </span>J2_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(<span class="dv">1</span>,n)]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb60-34"><a href="#cb60-34"></a>e2[n]&lt;-<span class="kw">abs</span>(magnetic[<span class="dv">1</span>]<span class="op">-</span>yhat2_<span class="dv">1</span>[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[n]<span class="op">-</span>yhat2_<span class="dv">1</span>[<span class="dv">2</span>])</span>
<span id="cb60-35"><a href="#cb60-35"></a>J3_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y_<span class="dv">1</span>) <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span>)</span>
<span id="cb60-36"><a href="#cb60-36"></a>logyhat3_<span class="dv">1</span> &lt;-<span class="st"> </span>J3_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(<span class="dv">1</span>,n)]</span>
<span id="cb60-37"><a href="#cb60-37"></a>yhat3_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3_<span class="dv">1</span>)</span>
<span id="cb60-38"><a href="#cb60-38"></a>e3[n]&lt;-<span class="kw">abs</span>(magnetic[<span class="dv">1</span>]<span class="op">-</span>yhat3_<span class="dv">1</span>[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[n]<span class="op">-</span>yhat3_<span class="dv">1</span>[<span class="dv">2</span>])</span>
<span id="cb60-39"><a href="#cb60-39"></a>J4_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y_<span class="dv">1</span>) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x_<span class="dv">1</span>))</span>
<span id="cb60-40"><a href="#cb60-40"></a>logyhat4_<span class="dv">1</span> &lt;-<span class="st"> </span>J4_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4_<span class="dv">1</span><span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(<span class="dv">1</span>,n)])</span>
<span id="cb60-41"><a href="#cb60-41"></a>yhat4_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4_<span class="dv">1</span>)</span>
<span id="cb60-42"><a href="#cb60-42"></a>e4[n] &lt;-<span class="st"> </span><span class="kw">abs</span>(magnetic[<span class="dv">1</span>]<span class="op">-</span>yhat4_<span class="dv">1</span>[<span class="dv">1</span>])<span class="op">+</span><span class="kw">abs</span>(magnetic[n]<span class="op">-</span>yhat4_<span class="dv">1</span>[<span class="dv">2</span>])</span>
<span id="cb60-43"><a href="#cb60-43"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 69.89954 67.47415 68.95209 72.13375</code></pre>
<p>According to the results above,the second model is the best.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="kw">print</span>(L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p><span class="math inline">\(\therefore\)</span> <span class="math display">\[
\hat{Y}=24.49262+(-1.39334)X+0.05452X^2
\]</span></p>
</div>
<div id="question-8.3" class="section level2">
<h2>Question 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>suppose <span class="math inline">\(X,Y\sim N(0,1)\)</span>,the sample size of X is 10,the sample size of Y is 15;null hypothesis is there are equal variances,alternative hypthesis is there are not equal variances.</p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>m&lt;-<span class="dv">999</span>;n1&lt;-<span class="st"> </span><span class="dv">10</span>;n2&lt;-<span class="st"> </span><span class="dv">15</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-3"><a href="#cb64-3"></a>x1&lt;-<span class="kw">rnorm</span>(n1);x2&lt;-<span class="kw">rnorm</span>(n2)</span>
<span id="cb64-4"><a href="#cb64-4"></a>z&lt;-<span class="kw">c</span>(x1,x2)</span>
<span id="cb64-5"><a href="#cb64-5"></a>out1 &lt;-<span class="st"> </span><span class="kw">sum</span>(x1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x2)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x2))</span>
<span id="cb64-6"><a href="#cb64-6"></a>out2 &lt;-<span class="st"> </span><span class="kw">sum</span>(x2 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x1)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x2 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x1))</span>
<span id="cb64-7"><a href="#cb64-7"></a>t0&lt;-<span class="kw">max</span>(<span class="kw">c</span>(out1, out2))</span>
<span id="cb64-8"><a href="#cb64-8"></a>d&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb64-9"><a href="#cb64-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb64-10"><a href="#cb64-10"></a>  q&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb64-11"><a href="#cb64-11"></a>  y1&lt;-z[q]</span>
<span id="cb64-12"><a href="#cb64-12"></a>  y2&lt;-z[<span class="op">-</span>q]</span>
<span id="cb64-13"><a href="#cb64-13"></a>  out_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(y1 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y2)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y1 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y2))</span>
<span id="cb64-14"><a href="#cb64-14"></a>  out_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sum</span>(y2 <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y1)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y2 <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y1))</span>
<span id="cb64-15"><a href="#cb64-15"></a>  d[i]&lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(out_<span class="dv">1</span>, out_<span class="dv">2</span>))</span>
<span id="cb64-16"><a href="#cb64-16"></a>}</span>
<span id="cb64-17"><a href="#cb64-17"></a>p&lt;-<span class="kw">mean</span>(<span class="kw">c</span>(t0,d)<span class="op">&gt;</span><span class="dv">5</span>)</span>
<span id="cb64-18"><a href="#cb64-18"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.122</code></pre>
<p>According to the results above,we can not reject the null hypothesis.the result accords with our assumption.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p>1,Unequal variances and equal expectations</p>
<p>2,Unequal variances and unequal expectations</p>
<p>3,Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>4,Unbalanced samples (say, 1 case versus 10 controls)</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p>codes as follows:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="kw">library</span>(boot);<span class="kw">library</span>(RANN);<span class="kw">library</span>(energy);<span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: &#39;RANN&#39;R4.0.3 </code></pre>
<pre><code>## Warning: &#39;energy&#39;R4.0.3 </code></pre>
<pre><code>## Warning: &#39;Ball&#39;R4.0.3 </code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>);n&lt;-<span class="dv">50</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>p.value_nn&lt;-p.value_energy&lt;-p.value_ball&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)<span class="co"># the container of p.value</span></span>
<span id="cb70-3"><a href="#cb70-3"></a>Tn3 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes) {</span>
<span id="cb70-4"><a href="#cb70-4"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb70-5"><a href="#cb70-5"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb70-6"><a href="#cb70-6"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb70-7"><a href="#cb70-7"></a>  o &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(z))</span>
<span id="cb70-8"><a href="#cb70-8"></a>  z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(z, o))</span>
<span id="cb70-9"><a href="#cb70-9"></a>  z &lt;-<span class="st"> </span>z[ix, ]</span>
<span id="cb70-10"><a href="#cb70-10"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(z, <span class="dt">k=</span><span class="dv">4</span>)</span>
<span id="cb70-11"><a href="#cb70-11"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1, ]</span>
<span id="cb70-12"><a href="#cb70-12"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n, ]</span>
<span id="cb70-13"><a href="#cb70-13"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb70-14"><a href="#cb70-14"></a>  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb70-15"><a href="#cb70-15"></a>  <span class="kw">return</span>((i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>n))</span>
<span id="cb70-16"><a href="#cb70-16"></a>}</span>
<span id="cb70-17"><a href="#cb70-17"></a><span class="co">## for question 1</span></span>
<span id="cb70-18"><a href="#cb70-18"></a>x1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>);y1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb70-19"><a href="#cb70-19"></a>x &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x1)</span>
<span id="cb70-20"><a href="#cb70-20"></a>y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y1)</span>
<span id="cb70-21"><a href="#cb70-21"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb70-22"><a href="#cb70-22"></a><span class="co"># as for nn</span></span>
<span id="cb70-23"><a href="#cb70-23"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>)</span>
<span id="cb70-24"><a href="#cb70-24"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3,</span>
<span id="cb70-25"><a href="#cb70-25"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</span>
<span id="cb70-26"><a href="#cb70-26"></a>tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-27"><a href="#cb70-27"></a>p.value_nn[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-28"><a href="#cb70-28"></a><span class="co"># as for energy</span></span>
<span id="cb70-29"><a href="#cb70-29"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-30"><a href="#cb70-30"></a>p.value_energy[<span class="dv">1</span>] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb70-31"><a href="#cb70-31"></a><span class="co"># as for ball</span></span>
<span id="cb70-32"><a href="#cb70-32"></a>obq &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-33"><a href="#cb70-33"></a>p.value_ball[<span class="dv">1</span>]&lt;-obq<span class="op">$</span>p.value</span>
<span id="cb70-34"><a href="#cb70-34"></a><span class="co">## for question 2</span></span>
<span id="cb70-35"><a href="#cb70-35"></a>x2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">1</span>);y2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)<span class="co">#Unequal variances and expectations</span></span>
<span id="cb70-36"><a href="#cb70-36"></a>x &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x2)</span>
<span id="cb70-37"><a href="#cb70-37"></a>y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y2)</span>
<span id="cb70-38"><a href="#cb70-38"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb70-39"><a href="#cb70-39"></a><span class="co"># as for nn</span></span>
<span id="cb70-40"><a href="#cb70-40"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>)</span>
<span id="cb70-41"><a href="#cb70-41"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3,</span>
<span id="cb70-42"><a href="#cb70-42"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</span>
<span id="cb70-43"><a href="#cb70-43"></a>tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-44"><a href="#cb70-44"></a>p.value_nn[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-45"><a href="#cb70-45"></a><span class="co"># as for energy</span></span>
<span id="cb70-46"><a href="#cb70-46"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-47"><a href="#cb70-47"></a>p.value_energy[<span class="dv">2</span>] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb70-48"><a href="#cb70-48"></a><span class="co"># as for ball</span></span>
<span id="cb70-49"><a href="#cb70-49"></a>obq &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-50"><a href="#cb70-50"></a>p.value_ball[<span class="dv">2</span>]&lt;-obq<span class="op">$</span>p.value</span>
<span id="cb70-51"><a href="#cb70-51"></a><span class="co">## for the first part of question 3</span></span>
<span id="cb70-52"><a href="#cb70-52"></a>x3_<span class="dv">1</span>&lt;-<span class="kw">rt</span>(n,<span class="dv">1</span>);y3_<span class="dv">1</span>&lt;-<span class="kw">rt</span>(n,<span class="dv">1</span>)<span class="co">#t distribution with 1 df</span></span>
<span id="cb70-53"><a href="#cb70-53"></a>x &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x3_<span class="dv">1</span>)</span>
<span id="cb70-54"><a href="#cb70-54"></a>y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y3_<span class="dv">1</span>)</span>
<span id="cb70-55"><a href="#cb70-55"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb70-56"><a href="#cb70-56"></a><span class="co"># as for nn</span></span>
<span id="cb70-57"><a href="#cb70-57"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>)</span>
<span id="cb70-58"><a href="#cb70-58"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3,</span>
<span id="cb70-59"><a href="#cb70-59"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</span>
<span id="cb70-60"><a href="#cb70-60"></a>tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-61"><a href="#cb70-61"></a>p.value_nn[<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-62"><a href="#cb70-62"></a><span class="co"># as for energy</span></span>
<span id="cb70-63"><a href="#cb70-63"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-64"><a href="#cb70-64"></a>p.value_energy[<span class="dv">3</span>] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb70-65"><a href="#cb70-65"></a><span class="co"># as for ball</span></span>
<span id="cb70-66"><a href="#cb70-66"></a>obq &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-67"><a href="#cb70-67"></a>p.value_ball[<span class="dv">3</span>]&lt;-obq<span class="op">$</span>p.value</span>
<span id="cb70-68"><a href="#cb70-68"></a><span class="co">## for the second part of question 3</span></span>
<span id="cb70-69"><a href="#cb70-69"></a><span class="co">#suppose the mixture of two normal distributions is 0.2*N(1,1)+0.8*N(0,2)</span></span>
<span id="cb70-70"><a href="#cb70-70"></a>mean&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">size=</span>n,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.8</span>,<span class="fl">0.2</span>))</span>
<span id="cb70-71"><a href="#cb70-71"></a>sigma&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">size=</span>n,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>))</span>
<span id="cb70-72"><a href="#cb70-72"></a>x3_<span class="dv">2</span>&lt;-<span class="kw">rnorm</span>(n,mean,sigma);y3_<span class="dv">2</span>&lt;-<span class="kw">rnorm</span>(n,mean,sigma)<span class="co">#mixture of two normal distributions</span></span>
<span id="cb70-73"><a href="#cb70-73"></a>x &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x3_<span class="dv">2</span>)</span>
<span id="cb70-74"><a href="#cb70-74"></a>y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y3_<span class="dv">2</span>)</span>
<span id="cb70-75"><a href="#cb70-75"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb70-76"><a href="#cb70-76"></a><span class="co"># as for nn</span></span>
<span id="cb70-77"><a href="#cb70-77"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>)</span>
<span id="cb70-78"><a href="#cb70-78"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3,</span>
<span id="cb70-79"><a href="#cb70-79"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</span>
<span id="cb70-80"><a href="#cb70-80"></a>tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-81"><a href="#cb70-81"></a>p.value_nn[<span class="dv">4</span>]&lt;-<span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-82"><a href="#cb70-82"></a><span class="co"># as for energy</span></span>
<span id="cb70-83"><a href="#cb70-83"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-84"><a href="#cb70-84"></a>p.value_energy[<span class="dv">4</span>] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb70-85"><a href="#cb70-85"></a><span class="co"># as for ball</span></span>
<span id="cb70-86"><a href="#cb70-86"></a>obq &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-87"><a href="#cb70-87"></a>p.value_ball[<span class="dv">4</span>]&lt;-obq<span class="op">$</span>p.value</span>
<span id="cb70-88"><a href="#cb70-88"></a><span class="co">## for question 4</span></span>
<span id="cb70-89"><a href="#cb70-89"></a>x4&lt;-<span class="kw">rnorm</span>(n);y4&lt;-<span class="kw">rnorm</span>(n<span class="dv">-10</span>)<span class="co">#Unbalanced samples</span></span>
<span id="cb70-90"><a href="#cb70-90"></a>x &lt;-<span class="st"> </span><span class="kw">as.vector</span>(x4)</span>
<span id="cb70-91"><a href="#cb70-91"></a>y &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y4)</span>
<span id="cb70-92"><a href="#cb70-92"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb70-93"><a href="#cb70-93"></a><span class="co"># as for nn</span></span>
<span id="cb70-94"><a href="#cb70-94"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">40</span>)</span>
<span id="cb70-95"><a href="#cb70-95"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn3,</span>
<span id="cb70-96"><a href="#cb70-96"></a>                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">R =</span> <span class="dv">999</span>, <span class="dt">sizes =</span> N)</span>
<span id="cb70-97"><a href="#cb70-97"></a>tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t, boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-98"><a href="#cb70-98"></a>p.value_nn[<span class="dv">5</span>]&lt;-<span class="kw">mean</span>(tb <span class="op">&gt;=</span><span class="st"> </span>boot.obj<span class="op">$</span>t0)</span>
<span id="cb70-99"><a href="#cb70-99"></a><span class="co"># as for energy</span></span>
<span id="cb70-100"><a href="#cb70-100"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-101"><a href="#cb70-101"></a>p.value_energy[<span class="dv">5</span>] &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb70-102"><a href="#cb70-102"></a><span class="co"># as for ball</span></span>
<span id="cb70-103"><a href="#cb70-103"></a>obq &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb70-104"><a href="#cb70-104"></a>p.value_ball[<span class="dv">5</span>]&lt;-obq<span class="op">$</span>p.value</span>
<span id="cb70-105"><a href="#cb70-105"></a><span class="co"># to sum up</span></span>
<span id="cb70-106"><a href="#cb70-106"></a>condition&lt;-<span class="kw">c</span>(<span class="st">&quot;Unequal variances&quot;</span>,<span class="st">&quot;Unequal variances and mean&quot;</span>,<span class="st">&quot;t distribution with 1 df&quot;</span></span>
<span id="cb70-107"><a href="#cb70-107"></a>     ,<span class="st">&quot;mixture of two normal distributions&quot;</span>,<span class="st">&quot;Unbalanced samples&quot;</span>)</span>
<span id="cb70-108"><a href="#cb70-108"></a>s&lt;-<span class="kw">data.frame</span>(condition,p.value_nn,p.value_energy,p.value_ball)</span>
<span id="cb70-109"><a href="#cb70-109"></a><span class="kw">print</span>(s)</span></code></pre></div>
<pre><code>##                             condition p.value_nn p.value_energy p.value_ball
## 1                   Unequal variances      0.027          0.006         0.01
## 2          Unequal variances and mean      0.002          0.001         0.01
## 3            t distribution with 1 df      0.881          0.570         0.91
## 4 mixture of two normal distributions      0.382          0.566         0.41
## 5                  Unbalanced samples      0.298          0.433         0.25</code></pre>
<p>According to the results above:as for Unequal variances,the p.value of energy is best;as for Unequal variances and mean,the p.value of energy is the best;as for t distribution with 1 df,the p.value of ball is the best;as for mixture of two normal distributions,the p.value of energy is the best;as for unbalanced samples,the p.value of energy is the best.what is more,all p.values accord with our hypotheses;in other words, the results above are right.</p>
</div>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(standard\ Laplace\ distribution\)</span>: <span class="math display">\[
f(x)=\frac{1}{2} e^{|x|},x\in R
\]</span> set <span class="math inline">\(g\left(.|X_t\right)\)</span> is the density function of <span class="math inline">\(N(X_t,\sigma^2)\)</span></p>
<p>compute <span class="math inline">\(r(X_t,Y)\)</span>: <span class="math display">\[
\begin{align}
r(X_t,Y)&amp;=\frac{f(Y)g(X_t|Y)}{f(X_t)g(Y|X_t)}\\
&amp;=\frac{f(Y)}{f(X_t)}\\
&amp;=e^{|X_t|-|Y|}
\end{align}
\]</span> codes as follows:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb72-2"><a href="#cb72-2"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb72-3"><a href="#cb72-3"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb72-4"><a href="#cb72-4"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb72-5"><a href="#cb72-5"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb72-7"><a href="#cb72-7"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb72-8"><a href="#cb72-8"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y)))</span>
<span id="cb72-9"><a href="#cb72-9"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb72-10"><a href="#cb72-10"></a>    <span class="cf">else</span> {</span>
<span id="cb72-11"><a href="#cb72-11"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb72-12"><a href="#cb72-12"></a>        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb72-13"><a href="#cb72-13"></a>      } }</span>
<span id="cb72-14"><a href="#cb72-14"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb72-15"><a href="#cb72-15"></a>}</span>
<span id="cb72-16"><a href="#cb72-16"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span> <span class="co">#the length of chain</span></span>
<span id="cb72-17"><a href="#cb72-17"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>) <span class="co"># parameters of normal distribution</span></span>
<span id="cb72-18"><a href="#cb72-18"></a>x0&lt;-<span class="dv">1</span></span>
<span id="cb72-19"><a href="#cb72-19"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb72-20"><a href="#cb72-20"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb72-21"><a href="#cb72-21"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb72-22"><a href="#cb72-22"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb72-23"><a href="#cb72-23"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb72-24"><a href="#cb72-24"></a><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span>N, rw2<span class="op">$</span>k<span class="op">/</span>N, rw3<span class="op">$</span>k<span class="op">/</span>N, rw4<span class="op">$</span>k<span class="op">/</span>N)) <span class="co"># k/N denotes rejection rate.</span></span></code></pre></div>
<pre><code>## [1] 0.0165 0.1705 0.4710 0.9100</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="kw">win.graph</span>(<span class="dt">width=</span><span class="fl">4.875</span>, <span class="dt">height=</span><span class="fl">2.5</span>,<span class="dt">pointsize=</span><span class="dv">8</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="kw">plot</span>(rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;x1&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZmUAZrU5AAA5ADk5AGU5OWU5OY85j7U5j9plAABlADllAGVlOQBlOY9lZgBlZrVlj9pltf2POQCPOTmPOWWPjzmP2/21ZgC1/rW1/v3ajznatWXa24/a/rXa/v39tWX924/929r9/rX9/tr9/v24eC3sAAAAK3RSTlP///////////////////////////////////////////////////////8AI8mn0AAAAAlwSFlzAAAOwwAADsMBx2+oZAAACKJJREFUeJztnYla4zYYRUdQCtNSQtfQKbTpDEmD3v8BG8ubrO1KjmUrzj3DN4D9a/FBlmRHTj5JEuTT0hUoHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgFRBx5//kTsh7t6z1KZARgja30t5eLwWQyME7Z7qhnQdJAva3H394/TtV7YgH4eHm9fD51f3TnEx5BMUJLrcpcktyOiD0v8wS8MWBChDUMG6KAhAQYBsgo6bujO+dU8UKUgenz1TIEe5BQ9qGU+xfehClYKSyqUgUC4FgXIpCJSbJGhemQUIEurfqKSZEoxKTEGAbILUpX3CMaT3V2f1cKUIij+GKxMkKChcruqAogVVUdclSDSCIutBQRGpKAikSr+fTUEo1QUJMl7VEN0QFimoGfSSirwoQUa5KYJUVD3kBXJ0pbtgQf0Yn0WQqNNdvCCZJMjTp7g2NoLOuhhbXlD9C/4rQ0H21tUIiqrIdQrSrzlAXcKCnD1NNys4w1BBgsBZVgsSFORN0U+CHCooqLnuTxPUprgWQe19kTRBzgTpFUXkXh80gSBtXztRbzK9BkFta/AJGnbg+pWMM8H4ivooRZAzsdYdm4LaxCl1id6pU5IgK7Vop4RrFgSuKQcToDUIAs9qTCqo7Wn6Tlno213FmVn7d4ZS6kz8rMY4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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">plot</span>(rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;x2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">plot</span>(rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;x3&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZmUAZrU5AAA5ADk5AGU5OWU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZrVltf2POQCPOTmPOWWPjzmPtY+P29qP2/21ZgC1Zjm1/rW1/v3ajznatWXa24/a/rXa/v39tWX924/929r9/rX9/tr9/v1Chy2jAAAAL3RSTlP/////////////////////////////////////////////////////////////AFqlOPcAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAinSURBVHic7d0JV+M2FAXgedAp0NKGoVvotIUpaYek4f3/n9fIq2xLuvIaJbn3zEKMrCd/yHbIEeGDMsF8OPYAUg+BQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoH0BtrdPW9Frl/dn5WTyVxA778/7+7f1Px1AvXs7miZDWj/+Lr7IfuvUa73F+bYmQ1IvzwfJpEapFF1j535gN6fzET56D7DUN10/OYDGlWXQAQaV5dACOjYQtL5AIVAIKcN1Ls7AsXuQCCwA4HADgQC9QkE6qcJNPl3++L4KDyAfu31uEDjuVIFMi94eEYQ3O8SgPYP+QtjntdcAZCeP5DublfdGRT5iuJFAKlurv4aeor5gYZZ+YHc/S10DXp/uhoAJJcDFAiBQEJAMheQOPYnkLXXhQOFDqUXkJwPkP+Bq5wQKFyOQKDcmQNJY0exH8AuLw9IWkCuQ++UO12g5iD6AfnvT50KFwAk8wPJpQFZ52IbSNq16xLpAUm9qTeQxABJTyBp7B+RAa8HyU1nhVlzcNYDH1DzSz8ZkFRdtZ9CLAb0/rTW7fUrAiq/iiJOIGkDSRNIBgHlBeS4QJnM/vHv8BpFmRqonomtCskB5a+27n/+LjiD8jHbQDIJkGizZYJAh2vQ+vDvNvyi/dxAUhxqA0jSAAonCCRjgORCgOzhI6B8cxNIhgJJqkAlSRuoPqK8Vb2fVtf8sosWUH0/qI+6qNUCkmpQDT1NHUiGAUk0kCQOJCGggqknkNRA1jMKL5B0gSRxoIrGBrKPWtW+AjeBZBiQpArkOsVaQPZ/44BEypOqMqg+Xexj128OFGcuoMaRaRyQjAcSCGTNqmSAWgMcDiQdIDkXILEGKO0HtlQbyNrFDWThtnqdHGgrV3/een/YcgxQ16TzIAKovY8F1Omr6i7/YBIg88OWh++zfD9s2RfIcXQQSKS4+UcBge2TA+0fX98/v3pfCiuzzSr51r9YQF6DeKBuq4FAMskMelpnTr8EZ1DRCvxQ7wiggAIA0vYm7Xw47hq0uztMi613bVSeYoKBH+p1H49GAA2ME6j7YIG7WDmD0Atm7qOIBepttQzQ/jcj8Dl8DdrdmiKR16AoIMdzgEGTKWKnsTPocH5tZR27awRQ+4mM8xgmBXI+45oM6HAC3YzhqYGsKT0ISO0tzlvUUYAOz4PQRXpKoNbxxwGVn+mex00g/9diOFB2h0fXoKmAsmfNjQZtoLoXbe7nBiq/s5gRaIJYQOWx18fiBnJ9o9YTyHqK6dqlbpQ+UA3iAVILSBtH27xTW536gFrPxpIH0nFAdSfVMVr9tIDKMVi71N/EpAWkvYC0N5CeEVB+XqgHSINACoGKsm4grYE0TSCdAEirYwVA6gDSCqgxUJy5FlCNAtL+QEX1ol6xRw2kywFFLqCygLQC0r5AGgSyr2pVfR+QLgQUuYCqBFI3kDXQNlC1WwmkISAFQLo4kHsBVRUbSF1A5UCb7RpAOh2QLg8Ut4CqDaR+oGKLB6hqEgmkTiCr7hLXIMcCKqlSj7MJpB6gakt5NfcAabXNulNHAOniQOFMApQ3dwE19m5e1epGCQBtva8aTQjk7lM7x3g5QIKA6rb29g5Q/YEDyNOpP7MDuUbUGV0XyN/6FID8mQPIVyMOyO7QPy39SQzI9UlfDQKhGs5KJwvkbFVt6APk6vD0gLIHBOpkAqBBZQkEysYBhYbgS0pAI8o69g0/5SFQoJp3oyvnARQ83nMACrbuXTeqWmzPBAI5CpB713MG6r6imG/t18eYAfT93KXNoGDH0RtdmfXdXwgE6hII1CUQqEsgUJdAoC6BQF0CgboEAnUJBOoSCNS9SCDwe1aHjSJrPBeQu1psw1l/z2q/Qz4PIPfvWfXUXfSQ+2W+U6zP71m9SCDn71l1v2CWctK4iyWceYEiFlClHgKBHA3oZDIrEEps9ch2R2lWhkAgBAIhEAiBQAgEQiAQAoEQCGQWoHMKgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEMgMQFtBb9r9kq3hy9t5W2drtOw27pZZM9ShWbNzE9NbN9MD7T89+97xvkjxPmhZO2/r/cPhkO027pZZM9jh5sa8fR/uzZHpgXb3b/mA/S2ykeXtfK3fP5s32rPbOFsWzSI61M0K9ubK9EBm6cdLcPZuvzFvVpm387c2547dxtMyaxbR4aFdRG/dHANI/3vTDRxoD6CIDg+nVExv3RzjFDNpTnhXi33MKVavtw13mP1SlUROMXz5M1+9zRpdLM2RR1xWy4kW7DDfkshFOu42v4K32563+WCHL2ZN2SqR2/yZhUAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiCQNIF872NpUizpXSppAoWSL+ldrFxqQGZ+rMwM2sr1H+vd9z/Jj0+HDZvmrNmsFhtQakDbm+zdUO+/fnreP6x3d8/mz/2/929mGa9ZSGfmju+NUudIakA7s+JZMxJ9WR9mUvHnVq6qNalmSe9iSQ0oI1q3gf65NstSixmULeldLKkBbcwC71V1ipVAN7otZ1Dc6t3JkhqQWbH78S2/SP9aAX19kG8f1lWDbNHvQkkOqE7cSvi5kyrQ/mHJaRJIqkDJhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACATyPysYbQktdeDCAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">plot</span>(rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;x4&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZmUAZrU5AAA5ADk5AGU5OWU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlOTllOY9lZgBlZrVlj49ltf2POQCPOTmPOWWPjzmP29qP2/21ZgC1Zjm1/rW1/v3ajznatWXa24/a/rXa/v39tWX924/929r9/rX9/tr9/v28FiwXAAAAL3RSTlP/////////////////////////////////////////////////////////////AFqlOPcAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAfpSURBVHic7d2Leto2AIbhqlmXdMtG2h3JupGubAVGdP+XN3yWg+RPxmfyf0/XJEyWzRvbUOLSN1Y19mbqDZh7AoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhDUM5BZTFMB9TvdcA0HdHi/2Rtz86XjeqduMKDnPzaH+51N/uu03qkbDOj48cvhh/RDbXWtD+2hit2A4Q6xz5vTTmQTpE7rpS6daHqg58dkR3nnP8IE1Nt6h5pIQD0tJyCYQEACguUEBMsJCJYTECwnIFhOQLDcNQA1/dFWQFZAPFhAMFhAzQOvFyh5yazjeq8W6PiQvbQaeNU++tWGqwWyh7vV+R7U+jXpKwaydvv2r86H2FUD2efHt30BBccvGqiH9QqIxgkIxgmoeTMEBJshINgMAcFmCAg2Q0DNm2F6ByqelWcT1yfwzTUXoMB2GDssUH1mAZmzPcgPBGjeRgE62xoBFV92Aoq+EwLitc4H6HBnbs8u4gytdxogMyXQ8+Pa7m++tAeqUQ0MZCcESmWOH/+Ouww4AqhYwvMMapFA2cvRx5+/62sPQqCIuzInoNM5aH36fR/3U43LgPI7GQeUD5wPUHNtgIwPKIfrCci4W2HdM4CAlgZkOgMF/tiSDTTLA3J/8hUJVKB0AErnXABQfvcnACrO/3Wg+kd3VuwFUPiyhLgcINsXUHn3gmskINsLEFyWEFd1XyKBTAVkgkCmmDSwxnGA/JcltKzlHuQ8984/zYFMPJDxAeWj+wVqviwhrjMgk7+65wWyzt02xbfeBcq+igQqDlk/UHXmdjeEq5+DGi5LiMu3B3n2pQag7J62AarjDAvUuX6AbHlqseWRGLr2KKdhINMd6Pjb6bfnT91P0rbY7QNA5X3yHWIlUHFswqPYiEB2/3azN+vYRb2bW36oNjMKyAwGVJ0Eq7V2OAfdxi7oLwxkiy1+CVScYSKAiiVqayxPWiGgctb6s4rIakCHu/WeztL7dGtCo8YAqhMFgGwA6MWGcrVz0C87PAclL7megndeGBaoPLcUJ28/kPvMqjgKuwHFlL8YDe+8MAaQs3wA6MUeVJ0JhwQq9qDml1zrQGYYoPzWmQElP/aJOAe5T+4QqDxSrK3f3grI2HkANVdtQBug8rZyXL7wGVB1XnG/FeX3IwRU6C4JqHrQbgHkrOaagcygQMYFMnMHyj6tAzk7kYCyTzsAmTig4uYzIPOagJy7Vz3jIiCzJKD8MxfIukDlg30xhXEp/CsEIGeu2QLZCuh8D3KBzqeIBSoXbQByPgRn8zQGkB0QyJ7tdNURuSSg4qEmAsg6U3QAsjMHqn3pHgTtgfxTV6OuE8jaKCDn1kuA3Lnqtw0H1O4axeJDGKi+P9UWXiRQy2sUiw91oPzzXoDc2bOlGoCCGxqun2sUQ+uNArK2G5D1A9lpgFpeo1h8YCDPXBcCNd/Ks9Xr5xpFU+bdjNp3dWAgOzVQc7TeVwK0D/70rA0QLScgWO4FUPOsni8E5F/aP/9izkGBu9wNiDdhMUBtlvM9LF66CVcKFHh4u2ATBASbICDYBAHBJggINuEqgS6c7DqBepxMQJcsNTJQD+/EGdMigXp6J86oFgkEf+VFQLafd+KMaqlAnr/yEnrJtVuLBWpotkAXzz3yC2atEhAkIKhHoMvnfiXnoMvnFhA0Z6AhN+EVA8UlIEhAkICgyYAW00RAOVO/4yYZViQgSECQgCABQQKCBAQJCBIQNAjQNSUgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhA0ANDe0Jt2P6VX6mfjgqPTdwlxx/hHpsNowudHk7xnDc92Xv9Axw+b0Fvh5uXv/5GOC44+PpzusjvGPzIdhhNub5O3reHZPPUPdLjfwb/OkW1ZNi40+vlT8gYz7hjvyHxYxIR2u8LZfPUPlFwC+9S49+6/Sd6kKRsXHp0cO+6YwMh0WMSEp3ERs503BZD9b2e3uKEtgCImPB1SMbOdN8UhllTf4X0jjjGHWPVmYc0THt5vbMxs501xkk6+e9s1nSyTex5xWi12tMYJs1tmcpKOe5hf4cNty4f5xgmfkmvKVjN5mL+yBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAoBkCHe53Df83vR5om17VO0ozBGosvew3uX7uMeryp+7NCii53nuV3P29uflzffj+J/Pj4+kGZ3/JLvvdrsbbplkB7W+TI+hw//XD5viwPrzfJL/u/73fJdfwJlfRrbND7On3u9d5iGX/yG1KYp/Wpz0p/3VnqrdAT4He7eKu4e2hWQGlROuXQP/cJNek1vagtR3tMJsV0Da5untVHmIF0K3d1/eg6KvAe2hWQMnluu922Un61xLo64P59qHkKB7mxzpPzwuoKu4y+BGaJVDyz7+M+Eje2CyB5pSAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCPofbLHGkKR1fh8AAAAASUVORK5CYII=" /><!-- --></p>
<p>According to the results above,Only the second and third chain has a rejection rate in the range [0.15, 0.5].And there is the best performance when sigma is equal to 2.</p>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>The target distribution is standard Laplace distribution,and the proposal distribution is <span class="math inline">\(N(X_t,\sigma^2)\)</span>.</p>
<p>The scalar summary statistic <span class="math inline">\(\psi_{ij}\)</span> is the mean of the ith chain up to time j.</p>
<p>codes as follows:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># the first step:generate laplace chains</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>dn&lt;-<span class="cf">function</span>(x,y){</span>
<span id="cb78-3"><a href="#cb78-3"></a>  z&lt;-<span class="kw">exp</span>(<span class="kw">abs</span>(x)<span class="op">-</span><span class="kw">abs</span>(y))</span>
<span id="cb78-4"><a href="#cb78-4"></a>  <span class="kw">return</span>(z)</span>
<span id="cb78-5"><a href="#cb78-5"></a>}<span class="co">#</span></span>
<span id="cb78-6"><a href="#cb78-6"></a>laplace.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb78-7"><a href="#cb78-7"></a>  <span class="co">#Implement a random walk Metropolis sampler for generating the</span></span>
<span id="cb78-8"><a href="#cb78-8"></a>  <span class="co">#standard Laplace distribution</span></span>
<span id="cb78-9"><a href="#cb78-9"></a>  <span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb78-10"><a href="#cb78-10"></a>  <span class="co">#and starting value X1</span></span>
<span id="cb78-11"><a href="#cb78-11"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb78-12"><a href="#cb78-12"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb78-13"><a href="#cb78-13"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb78-14"><a href="#cb78-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb78-15"><a href="#cb78-15"></a>    xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb78-16"><a href="#cb78-16"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb78-17"><a href="#cb78-17"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">dn</span>(x[i<span class="dv">-1</span>],y))</span>
<span id="cb78-18"><a href="#cb78-18"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb78-19"><a href="#cb78-19"></a>    <span class="cf">else</span> {</span>
<span id="cb78-20"><a href="#cb78-20"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb78-21"><a href="#cb78-21"></a>    }</span>
<span id="cb78-22"><a href="#cb78-22"></a>  }</span>
<span id="cb78-23"><a href="#cb78-23"></a>  <span class="kw">return</span>(x)</span>
<span id="cb78-24"><a href="#cb78-24"></a>}</span>
<span id="cb78-25"><a href="#cb78-25"></a><span class="co"># the second step:compute Gelman.Rubin statistic(grs)</span></span>
<span id="cb78-26"><a href="#cb78-26"></a><span class="co"># The scalar summary statistic is the</span></span>
<span id="cb78-27"><a href="#cb78-27"></a><span class="co"># mean of the ith chain up to time j.</span></span>
<span id="cb78-28"><a href="#cb78-28"></a>grs &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb78-29"><a href="#cb78-29"></a>  <span class="co"># psi[i,j] is the sum of X[i,1:j]</span></span>
<span id="cb78-30"><a href="#cb78-30"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb78-31"><a href="#cb78-31"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb78-32"><a href="#cb78-32"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb78-33"><a href="#cb78-33"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb78-34"><a href="#cb78-34"></a>  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb78-35"><a href="#cb78-35"></a>  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb78-36"><a href="#cb78-36"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb78-37"><a href="#cb78-37"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb78-38"><a href="#cb78-38"></a>  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb78-39"><a href="#cb78-39"></a>  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb78-40"><a href="#cb78-40"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb78-41"><a href="#cb78-41"></a>}</span>
<span id="cb78-42"><a href="#cb78-42"></a><span class="co"># the third step:set relevant parameter</span></span>
<span id="cb78-43"><a href="#cb78-43"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb78-44"><a href="#cb78-44"></a><span class="co">#according to the exercise above,there is the best performance</span></span>
<span id="cb78-45"><a href="#cb78-45"></a><span class="co">#when sigma is equal to 2.</span></span>
<span id="cb78-46"><a href="#cb78-46"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb78-47"><a href="#cb78-47"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb78-48"><a href="#cb78-48"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb78-49"><a href="#cb78-49"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb78-50"><a href="#cb78-50"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb78-51"><a href="#cb78-51"></a><span class="co">#generate the chains</span></span>
<span id="cb78-52"><a href="#cb78-52"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb78-53"><a href="#cb78-53"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb78-54"><a href="#cb78-54"></a>  X[i, ] &lt;-<span class="st"> </span><span class="kw">laplace.chain</span>(sigma, n, x0[i])</span>
<span id="cb78-55"><a href="#cb78-55"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb78-56"><a href="#cb78-56"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb78-57"><a href="#cb78-57"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb78-58"><a href="#cb78-58"></a>  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb78-59"><a href="#cb78-59"></a><span class="kw">print</span>(<span class="kw">grs</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.116127</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="kw">win.graph</span>(<span class="dt">width=</span><span class="fl">4.875</span>, <span class="dt">height=</span><span class="fl">2.5</span>,<span class="dt">pointsize=</span><span class="dv">8</span>)</span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb80-5"><a href="#cb80-5"></a>  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb80-6"><a href="#cb80-6"></a>       <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5Zo85j9plAABlADllAGVlOTllOWVlZjllZmVlZo9ltf2POQCPOTmPOWWPZmWP29qP2/21ZgC1tbW129q1/rW1/v3ajznaj2XatWXatdra24/a27Xa29ra2/3a/v39tWX924/929r9/rX9/tr9/v3E9KJ1AAAAMnRSTlP/////////////////////////////////////////////////////////////////AA1QmO8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAatSURBVHic7Z0Pd9o2FEfrpEm7daPt1jTJtqRd2L+sZODv/+UWgzE2Mb7PIFmS/bs9B3qSh2RuZEl+kuFVLjp5FfoAYkeCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCgN6CFlnB2Z2Pg4mRvoJWN9fF09O7bx4OJkb6Clp+fKg9TYBjW9DbdkFZMvgSlD9dFsUf6oPM9YbGnyBH9YbGn6DuUUyCYBSLX1DZ+3gTBKNYnII2Uoqeueqevbeg5ijWf3DwzPZANke0fqzr8dkHpTGKVQ1l02zyF3+7qY9iZXPetJys5bh8C4q9D9p2OtmuMbUEWBhfC9o0nc1/O6KsxY1NkHWwmOBEcTuW57sxrCvaWmzCE8W9dlL1yrYXW2tJdqL44kzqNw8beKLYv94TaXQ1u3OrRwHWwDQniuXcJqv3Oz1LsAamNYpVFwpbJdvrq94XOWMVlNWf8vJUOzQZ7CzJGpiEoF3D2dfR/+p8r0gkBUHltXjV69Say9EJhJEJyvJqkvNiriNBeVYf1R3lnMYkqExXuM3GjURQM9MlQS9K85fFHY0gp+XVi7YGuhHkOGl/7OSmTxXWwBhbkCUjeHId1sBYBe1NCJ2TtiCv3XNVh41oBDUzF5nPDjrPUxZUXUpIUPMF2+uIgdavkxNU7SwYaHk/HUG7i/T1Pwnaf0E1w8yOSr4fS3KCqulz8oLcrqxmWZXJGHZvUSorq2X8iAQ5XlnNdk8jEeR4ZbUuqOdLTyOJldXBJj2tdRsJOIoNNWlur9waGFJQwAaUiKCA+BvF3m8mducnd9Jh91T7a0HLD103G0rQ81T6dcfNhn0E9a7ZJfGvagS+a8G3oNNn0ukJWv3l4D7dHoJOr+wUjhF0c/b9569D1Rv6vqCjTrHVP19uZ/QCR+mOwH6OEvTf4+Pj32+//tsZ7yrdkaCg1a9XV1ef3vzwubMrcpXuSFDQmj8vIN5VuiNFQX98l2U/4kjmKN2RoKDlz78NVG/QPMf2GKyBR00UFwdPREu9g62edh6ENTCIoOCzoMgFhZ8mxp0wCy6nIC5BmSFmYGIR1LJmGv70KohIUGPIiqL/KYhUUFZtYA2NBAGRCNrPxHrfm2kmIkF5LkEtSfus+nlNUBRz6A3BW1ApqPlREdGMYREJamw8HH6Xy0HiFRQJoQXtG5GgvXpbBcXS/xRIEBBeUPMTR+pjWRREISiToIP1ShDU2yrIbVWn4U+QbW2+RVBUDcifIOPa/HQFGdfmy3vjGoJ61uQX7y0I1uanK8i2Nt+W/ZiKIFO91UevVT+PJVG2xWsLusA+qEyTNZPRUeG1D1qcP/QVFNkY5nsUW3783Sao9oupCFrdFt3z8qfuUay8spiioOc+qBjnF903s7y8spiOoPbq9sb1lkuviQmiTvrgb2Ih9DzIbakekCAgcLpjwoJs6Y4JC7KlOyYsyJbumLAgY7qjb6mDo1EM8CsIN5JLENQrQVDv1AVhvRIE9UpQd72xJX9aCL02Hz0SBEgQIEFAMEHJEEhQqanPjx0Eu6jvEBIESBAgQYAEARIESBAgQYAEAV4EjQkJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAJAiQIkCBAggAPghZZds1R89k2sv7YHpoVt8magosN7qsbezzjXtDyw92hbeY1ni5nZWT9sT303bfVzbUpePn+/CGfX+TWeAPuBRXv57brG6QKVrefZmVk/bGjQEvw6pftvbTzmbFwxL2gYgvsPTXo+ez5FNtE1h/bg58uz+6MwbtbSayFE2EEPf9J7YIWr4tTrI+g4jvQ4hVkac/zYoeO9SxYd+cXtuC1oKc3d20n5nFvJ1QnXbxtYz9afOPb/cwWXAja/CreTtr9MH/fb5i/XzfPeIf5kSFBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBCQg69NnVwxC/oPXW3nBEL2i3tTcM0QvSKYZIECBBgAQBEhQ1EgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBwP//dLvsTRwlKAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5Zo85j9plAABlADllAGVlOWVlOY9lZjllZmVlZo9lj9pltf2POQCPOTmPOWWPZmWP29qP2/21ZgC1tbW129q1/rW1/v3ajznaj2XatWXatdra24/a27Xa29ra2/3a/v39tWX924/929r9/rX9/tr9/v3lznmeAAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGxUlEQVR4nO3dAX/aRACG8V3XbtMpm7rOtmrrHOqso5Z8/w8nIYFc4HLPEXLkwr3PT9tKr1z6NyQEku1Foby9GHsBUk9AkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhA0KFAzz98LubGXH6NsjQJ1gNocVUUT29zEeoBNJ9VK1IeHQz07vLLz6tPP7nXIDOZYgGtHl2vLu6fXt+7vxk879hFBBpm3rGLB7RYr6AXWoM6Wt7elJ+69mLueRNkiwZU77669mLOecO3iKcr+hr0pgXk3zlkBbTaiR28Darddp1GZUtqL5Yj0IHboF0g09w6UmmtQRaI2Q4TkHWjBVR+XP1bfj5PoB5PFLdAZgtkzhaozxNFs9781B8rmerTiEJpPVHsABpzFTrxE0X/vFkB9XqiWG2W6y+sR9dZAvWY1xTNGmO2+7Fi1GMQAUGpARWFC2jEx1jCQPZAATU3Njsya6CAmht3gDzDT5KAoPSAqi9CgE5yEDIVINf4zUu3UZESBdp7DcgxfvPaducr3Mcs3+H3cmogHm+2x/ouoJ1be2ulCbT/7f3x1gtqrhcdrQ2Ue8AxC+oqTaB669QF1DruHXBBXZ0AyLcs7dcVrYOQ+r9NM8Z64800/9VXaTpAOyDtLcwWyLSBrJdspwHkfWfVuyx7QHvfb/5pDuTaP9RnUz2VNaj1u7qEjW3vBuq1L5sgUPeKgNuZHo+xKQGZ9heuMfQLuX4WfsL7XasUgLZ7o84xPG8zpvU47PzJyQBttjy+B1HQI2jv6Xr3XiNgoZrSATp25p1tGa2Vofc7PlD1Kx1/CLpdb6odv3Fuu5pNXujdpgB0zDFVe5rNCyXNqtPeIpnpAg0xtcViWjAbOfs5V+jdxgPa261Err1NNvat2y2SY+moswJy3ty8Ate+ObCIQJst74mA/O0dwoT+YC5AuyUBVL/0nhcQXHG4B9TvxYj4xQTyXXHoABrxFA5PMYF8VxwKiK44tL40znebE6kH0PLvsOt0Q684PD+g24tvP34abN7mIP1cgFZE//x+N6MfCD2RfP+l9qTqA/Tf4+Pjlzef/vWODz6RfHPwfD5Ay1+vr68/vP7uo3dTFHwi+fkBrfvrCsYHn0h+hkB/fmPM97gnCzyRfHPuQZI6RS+g5x9/6z+d9e7e5pZkD8PWxT5YxW1Q7kA4b8IH8usEBMUDCnyimC5NVTSg0CeK2QKFPlHMFijwiWKah/BW8bZBYU8UMwYKmzdzoEXnEZuA1gkIEtDR8woI5hWQf95E3wyzEhA0NtCw9xohAUECggQECQgSECQgSEDQiYF23zgUEMwrIJhXQDCvgGBeAcG8AoJ5BQTzCgjmFRDMKyCYV0Awr4BgXgHBvAKCeTMGCrskM2+ggEsy8wYKuCQzZ6CgSzIzBgq7JDNroJB5BQTzCsg/b/Inv0TdSFdv77z07cVyBiqe33dsn+15cwYqFr6/Sj19mbqR31lNv9hAB/39Yik29mnAyTca0GSKBuS/JLNmOuTmAQYPMV9XA1+S6V2GLIDgkkzvMmQBBJdkepchCyC4JNO7DHkAhZQ9UPcFdd5lEBAsg4BgGfIByikBQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkICgCEALY254VHkycTXS/ugeasxV4ODy/brlbfh4bnig5/f3/nfN1j29mtUj7Y/uoW+/Lm9vggY/v3v5uZhfFaHjAxoeqPx97rxvm61a3n2Y1SPtj547DBm8/OWP+h3f+SzwzrHhgcpX9B9ohZ7PVg+xaqT90T24PDM7cHDzznjonVPjAK3+l4YDLS7Lh9ghQOV5lOkChazP8/Lt69BHwXpzfhU2eA20vg4g3YdY4BZxHryRLs8afZiFDS6Bqm+lu5Eefjf/cNhu/mG9eqa7mz+zBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAoOSB6pN6Ryt5oOqk3vHmTx6orDwbbaymAOT/464iNwEg/x+OGrv0gTr/cO/TlDxQ7/N3Byp5oPqk3tFKHmjsBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQf8Db1Tf5nW1YsUAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAnFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5Zo85ZrU5j9plAABlADllAGVlOTllOWVlZjllZmVlZo9ltf2POQCPOTmPOWWPZmWP29qP2/21ZgC1Zjm1tbW129q1/rW1/v3ajznaj2XatWXatdra24/a27Xa29ra2/3a/v39tWX924/929r9/rX9/tr9/v12tChOAAAANHRSTlP///////////////////////////////////////////////////////////////////8AS1ciZQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAB3tJREFUeJztnAt70zYYRhFQYGNbgI1L2ZYy1u7GSJb4//+31UnsKK7t89mWbMV5D88T0kSW5FPdJfdRJlp5NHUGUkeCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQIECCAAkCJAiQICCwIHc2TCUobHTxkCBAgoCRBXWv2lObTL0E2U1GQoIoA9aAkwma2JAEUQasASUI6CxoteusHi+Hpeum7saiCdpef8j/W7/8OiRdN19Bmze33n99052xoKIEvRgiyM1YULZ+NrwNmrWgEOnmXdhsBQXoxdycBYXoxdoEjeUt6V6sVpDrEEEARu7Fuix3uP1Mda6ChvdihaCKzP1Po81Aku3FjuWsqGdF0XHH1xGILah3G3QiyM1XUO90jw1VKcj/8SIFnXx2bMhPBR1K1gwEdR8oVgWV7/bN0EGQX/tGIKWBojt5XxHkPEHZHAT1GCieCspaBZ3/OKj7codz9d8XjU7ZEDlfX2xSGSjuFdR+X/rxurL4gsouwnpB5F7Mc1D9vhCUXbgg1ySo6Ll2VcsTFFWROytBWVZ09H7nH1dQ50nx1IKKMP4VYbPkZ2YyQY3LHZWPa29+JEGnY/VES1DDzZ/2cwENuXI6XAzby3UVaxSxBVVbGMNlwQQ5byhRv/xkIL6gQy73P1ryFaqSndhJWZC/BmSLJIigk9WCBzFKUFlsG5o9azxzFeRg7y0dQZm/jmEVNNxQfcWqZMxCioICzMwwuQQFwa+0etnJFLZrLvj3kYggbwraUZALIag1BSPjCMp6CHJdGqPKIIcvO3dBzpVrjOZ0m6fEDReYGEtQtzMvxcTS3qqflLf5C8pc+c8W/KCzMvWzZ7SZZAUV8zhT6LZpqSmjzcRdDxpLUHmJeW+th6DtX/V7gZ2IJaj9wsqgJ5ag68ffvv9svc6Wri+o876pv/5nENSNXlVs+89vHxfd02pJtyqoW1xlmWtvWHpN3foI+u/Lly9/v/j8b/sF6+fLlXNP6jdWIwjaNy1thnqNt/tUsV/evXv39vl371ubou3HZX5wwXZ4obrW3PFOiqaluvtYCTWWoB1/XkH4zZvb9Q/WwwsDBR3iKAbVdaMi17MA9RL0xzfOfY892aflfSHKckmcbmVXvregrKmNt456aqK1BjwK2vz0q+WC7XWeqacNIt3J+4CCKm+9T0YTFIQIgry3vg5XNk49Io0pyH4E78E4eHBr6jdDA+RUo20l4hG8MIIqEXjVbVB80QR1OIL38A6GCsqOkoeVnxFKkOEIXu8GtA1f0KB4rAEjHsG7UEH1ydUtd8TwU95Z6oJMbVBcQcNatInHQcUcPGzkh6gPK2MS1JBCp+2R5misAeMMFOMKGlp6dtFYA8YZKBaLOB0jt+DCPLEw8UCxmH93jNyCfV2+PRprwDgDxbiCQkQ88UAxoiA/mTFiiNeLjfj4YA/iClo1LsxK0A6joBCz91ikIShhkmiDUkaCgImXOyQI0pUgSFeCIF0Jak83zJJNVCQIUBUDJAiYXlDKM9VMghAJAiYXFGfFPhwJCAobcWgkCJhaUOo1TIKIqdeDJKg9XQmidFP3I0FE1K3nKz5hdrmC8sMLqye3EtTEzszmze8S1ED+qM+9oR/hnPTlCrpvg/IDQquGRw4lyJiuBEG6EgTppu4nYi/2aj/ngjYoeeKVoM3rhuOJ3dKdmohVbNX0vGqndKdm4uWO9IktqHGqcTZEFtROQ+r1HwcIHCK9JiQICPy0T2seLkIQPO3TmoeLEARP+7Tm4SIEwdM+rXm4CEHwtE9rHi5DkIWLF9T8rEZrHiRojkgQEKUNmhMSBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQEEHQyrkPHOpuUYT0X+uDuvzksSlwvtuS/0lwa3gmvKDN62X7nseO9bPFIaT/Wh/05dft9QdT4M2rJ7fZ3VVmDW8gvKD8fj62bnpk+WHZt4tDSP+1JUJL4O3PxfHku4UxciS8oHw99oYK9N3ivortQ/qv9YHXzx4vjYGP+5rWyIlpBN3/Su2CVk/zKtZFUH4KLl1BlvJ8l28+WmvBrjm/sgXeCVo/X9ZVzH63M1Ujnd+2sR3Nz/zdLGyBc0H7r9JtpMN38zfduvmbXfFMt5ufGRIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBCQvqCb/md7QpC8oNUV/KmZyCQvKKO/xROZMxB0pypG9D3CG4KzEJQf+JyK5AUNOQQeguQF5d38hAXoDARNjAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIEPA/XLfre9OHCn0AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OTk5OWU5OY85ZmU5Zo85ZrU5j9plAABlADllAGVlOTllOWVlOY9lZjllZmVlZo9ltf2POQCPOTmPOWWPZmWP27WP29qP2/21ZgC1Zjm1tbW129q1/rW1/v3ajznaj2XatWXatdra24/a27Xa29ra2/3a/v39tWX924/929r9/rX9/tr9/v3zumUyAAAANnRSTlP//////////////////////////////////////////////////////////////////////wChj04xAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHvUlEQVR4nO2dC3ubNhSGq6RJunWb02xrmqRbna6Ld8tqz9b//2sL5mIuEt8BdIww3/s8tQkWErwVumO/sqSVV2OfQOxQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKCzoM3Vcm3M+ZPGycRIV0G7h+Xm7Veb/JsHXQVtb542P+zfVE4nPjrfYp+XL5nIJpJcmMmgJmh3n0T/2nOHidMdGz1BgdIdGwoCRCAobldqgrbXaRnnaQhRkN2+WzqSc1QOcxVk174arJbubAVJ0/WcQiTetAX5WtIUJE/XeQqGgtpPYQaC1vvK6sxRldXSnamg3f1d8uYb7jik6+4Onr6grHTGhfRcBeU56I1IUP00uowz6KJXBm0uZWWQV1AchsavxXyCbByK4hRkKIiCxOlSEEg3dVH7dLaCHONBTkH7htAcBTnSdQgyJg1AQfstCmpP1yOoGmg84hTUCDQeFARQ7YtdCHrzZq6Ckt78+vyJgnzszWxvfpcIqrd45IL0FerloIdkoGP7IxoPSpvMVUMdBKkb0iyDkhGzNZp6No7Bn0IQPLspCxKma7J6rPyZaW75olE3NLIgM1SQeik0FUHu8zQTFiRa/mKAIJt1ynxZyXS4gJ7o5SDJ8hepIN8Q/qQFiZa/ZIKq52Eqm652QPnjzufVjTjKoHZBvuW45hQEga5GcY3tgtz3mKmb1SCKHGRbBWXD+i5BloJOWJBo+QsWVIhpGpq2INnyFyio2Wis7ZisINnyF2Prl219ghohTeNADdRzUPtwR3dB9d7HZAXJlr8cBJnGZ/X9Jm83VoJNV5Ao3U6C0nbPTAVZLMhSUHOzJqu0pKF4D3teDXoI2v0V4DndRuvGI6hyTNrtj1/Q/dm3H74ESreLIGtKIyMRC3pR9M9vD4t+ydWXv5ykoP+en5//fvPl3xDp9hGU9c2iFbT75fb29v3Vdx+GFEVNQY0ms+ugtB4rD3No9zf61mJ/XoRJ13GvtU1l5JnHmJgF/fGNMd8PrMnCCap3dQPTQ9D2p0/h0u0lyMYtSMjm8uzXa++3vwwTZKuCNKdX1QTtPj4lEz/bn9sfh+ooqHJs/pfq/LOaoO3Nfm0QWh/UEOSb4XEcezhA0ZB2DkIP1PURVI+quc46IHpl0Np0KoNK3dfughRL6ZF7882NftlBLwtp5iDBiGJlI2vz9brY6QmSPtQ7W0HSh3rLgoydkSD3rEbzaZ/ZCpI+1DtfQcJ0QwnSqse0BR2rDFKr6CPKQYaCXOmGEqRlKJ6Gog0nKKSreBqKQwXZiQkSf/vLYVcuqGNKlSiz6elwho7cUGxLN5igoONDozcUS7uy0dMhgvJmejhDo9di5V3DrswcejIBh/KjEzQgyvKKajOgtK+dlZD4BVXmpIONVEcmaNA1mdK611MU1GfAvnZ4bTuEoSMLao4H1T8eFHt92zR2D4qzlaN8I3noQYuTExS6x2mGR0pBoigETFTQ4J7ZHAQNa1xJA/YSlH4/RYd0QwsqLxzuGYU0oN6vIlR26wga0oGRBuzRm1+MnoPSLlmkgqxdnX3qKij8/NbQwQ/VMmh37xsOOq6gPoaK9UrSA4702z4KgmwfQUVvaPRZDeH+YRyeYJAfkW9Ij1D7TnvZ/mHU6nqciGNxBUJ/VkMVU77VcLl9BEHS5S/HIp8OMmUcYbKx7cM+aQL6sxrKlOQUf3iDlPZJ45/8L9QZU9VSKrfLzo4tKJYyyBad1sYcfpGpnEXTfHJQm6DDnNysBXmyRzFX5Kw5YmsoKuK4/qLq91ersTUUNXEIygtkf7NjLg1FD4UgfwhpVPrLX+JkPg3FnsyoFusHBQFGEzQZRhKUaeqyO0DgEOn5oCAABQEoCEBBAAoCUBCAggAUBFARdEpQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAigIWhtzh0OtFnnI8qs7qEl+wV0UOFm3tLuXh8eEF7R9t/StHiqRPHaWhiy/uoO+/bq7vxMF3l6fP9nVhZWGFxBeUHI93ufJcnYP7xdZyPJrS4SSwLuP+c+8rxbCyCHhBa1fsvcjytCrxcstloYsv7oDby7PlsLAhxWC0sgR4wh6+S+VC1q/Tm6xLoKSrwSPV5AkP6+SFTrSu2BfnF/IAu8Fba6Wrhuz3+WMVUgnly0sR5PfTn5cyAIngtKP4i2kw1fzj92q+cd99oy3mj8xKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASYgqBkKdFoTEBQsmJ4POIXtF8xPB7xC9qvGB6P6AWlK4bHI3pB6Yrh8dKPXpBlLQahoJihIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wMqNkkcSErIHQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">pin=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)) <span class="co">#restore default</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="kw">win.graph</span>(<span class="dt">width=</span><span class="fl">4.875</span>, <span class="dt">height=</span><span class="fl">2.5</span>,<span class="dt">pointsize=</span><span class="dv">8</span>)</span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>rhat &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb81-5"><a href="#cb81-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb81-6"><a href="#cb81-6"></a>  rhat[j] &lt;-<span class="st"> </span><span class="kw">grs</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb81-8"><a href="#cb81-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb81-9"><a href="#cb81-9"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OY85j9plAABlADllAGVlOTllOY9lZjllj9pltf2POQCPOTmPOWWP29qP2/21ZgC1/rW1/v3ajzna24/a/v39tWX924/929r9/rX9/tr9/v26GKLiAAAAJHRSTlP//////////////////////////////////////////////wBYLA0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFZ0lEQVR4nO3dcV/aRhyA8dKqa6ndVnXTlRWG9/7fYwnoAIU8l5BLfpDn+QM/xSuh3x4HhBg/JKvtw9B3IHoCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQR0DTc6moYC6vblyCQQJBA0LdAZMA8+g+EICQQJBAkECQQJBAkECQUMDhRca+q2GQLBdgWC7AsF2BYLtjhdo+e1Hmk0mVz/rtztqoPl1Sosvh4X+B4ouVBJoNt1MpNrtjhfo69W/31df/qifQeMFWj26bj4+Ln57hO2OGChvu+MFWtxMrl2Djvd8f5fmn34IdKy1zPLbPwgUXKjcDHqolufl75/3gA585D1WoNUadLe6XD3KYLujBcrd7siBcJGOvggNP4OCTyGBoAhAoYUCAMWeQgXfzW9e7+DT/FiB0vL2yBv5d9sdKVCaH9vd+na7oRehCGtQ6CkkEBQDKLBQCKDIUygIUFyhGECBp1AUoLBCQYDiTiGBoDBAUYXKAc3X71U/0ierje9IzxX9XCzx0R3N70jPlf1cLGef9OsVQYVOAPqv5s36dgZ9zgSKOoXaAC1uJtOUno7sCtsZ1WQNijqFWgCt5sby9u978Gm+3YsB2hx9OKW/kHl0R4u70mttga5pfO7RHTtXhRRqC4QTKPfojjb3pc+KAdHRHS9HeOx9nbz5c4ivLYDqP9B5LffoDrpy4KK8F9tcGVBo+KM7Wt2b/go1gwSi7QZ8jMUCCjiFogGFE4pwdEer+9NXEY7u2Ls+2hyKcHTHm+/EEgq2Bq2/1eYUa8UKCLQ3bHCj4EBp8FUpPtDA0+gcgNKQRmcClAYzOh+gNMxydFZAQ0yjMwNK252hPVX0o+eMU1O0q0ejkkA5p6ZoXV+vtUsCZZ2a4tRKKxXc3ZF3aopOKmhUcJHOOzVFV5UyOr9nsZrbLGF0SUCpxEvJCwPqfhpF2yfdRZ0+r/W8T7q3XYWdbSLePunO6ub/4eLWoDebOZko1sELBTp1Gl34DNps6xSjMQClU4xGApRaG40HKLUzusQXinU1Nop28EIPNTO64BeKNTUwGtUatHcHMo1GC5Qy34uMGagKicYOhI81gVK9kUCbjq5HAm07aCTQXu8nkkDv2kcS6GBbJIEggSCBIIGgwYDOpoGAXpiaXN3B4C62dyyBIIEggSCBIIEggSCBIIGgIkCXlECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEBQAaD5ZHLHo6oTXGxG7l4eHjqpTqOfNbj6Qb/n+/zxXPdAy9vHY791Y6fFzfRl5O7l4aFffq5/Y0PG4OXXT+sT8+eOz6h7oOrf81D3Ay9Vzw9/Tl9G7l7W3GDO4Oe/Xs+1P5tm3jjWPVB19pwnmtCz6eohthm5e3l4cHW2kMzB29+sk3vj1DBAq//SfKD5VfUQawJU/chWXKCc+TyrjtDJfRSsl/PrvMFroPW5aeI+xDJXxFn2Il39gNrTNG9wBbT5VtxFuvun+admT/NP6+kZ92n+whIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEgj6BboTkx7oLPmJAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points A(k) in (0, <span class="math inline">\(\sqrt{k}\)</span>) of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^2(k)}{k+1-a^2}}\right)
\]</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[
\begin{align}
S_{k-1}(a)-S_{k}(a)&amp;=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)-P\left(t(k)&gt;\sqrt{\frac{a^2(k)}{k+1-a^2}}\right)\\
&amp;=1-F_{t(k-1)}\left(\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)-\left(1-F_{t(k)}\left(\sqrt{\frac{a^2(k)}{k+1-a^2}}\right)\right)\\
&amp;=F_{t(k)}\left(\sqrt{\frac{a^2(k)}{k+1-a^2}}\right)-F_{t(k-1)}\left(\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)
\end{align}
\]</span> codes as follows:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a>s&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="kw">library</span>(rootSolve)</span></code></pre></div>
<pre><code>## Warning: &#39;rootSolve&#39;R4.0.3 </code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># the third exercise</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb84-3"><a href="#cb84-3"></a>  f&lt;-<span class="cf">function</span>(a){</span>
<span id="cb84-4"><a href="#cb84-4"></a>    y1&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k[i]<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb84-5"><a href="#cb84-5"></a>    y2&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb84-6"><a href="#cb84-6"></a>    a1&lt;-<span class="kw">pt</span>(y1,k[i],<span class="dt">log.p =</span> <span class="ot">FALSE</span>)</span>
<span id="cb84-7"><a href="#cb84-7"></a>    a2&lt;-<span class="kw">pt</span>(y2,k[i]<span class="op">-</span><span class="dv">1</span>,<span class="dt">log.p=</span><span class="ot">FALSE</span>)</span>
<span id="cb84-8"><a href="#cb84-8"></a>    <span class="kw">return</span>(a1<span class="op">-</span>a2)</span>
<span id="cb84-9"><a href="#cb84-9"></a>  }</span>
<span id="cb84-10"><a href="#cb84-10"></a>  s[i]&lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">1e-3</span>,<span class="kw">sqrt</span>(k[i]<span class="op">-</span><span class="fl">1e-3</span>)))<span class="op">$</span>root</span>
<span id="cb84-11"><a href="#cb84-11"></a>}</span>
<span id="cb84-12"><a href="#cb84-12"></a><span class="kw">print</span>(s)</span></code></pre></div>
<pre><code>##  [1]  1.492103  1.533551  1.562766  1.584421  1.601153  1.614519  1.625383
##  [8]  1.634409  1.642026  1.648543  1.654174  1.659099  1.663453  1.667288
## [15]  1.670736  1.673840  1.676587  1.679140  1.681462  4.795727  4.898877
## [22]  4.999900  9.999950 22.360657 31.622761</code></pre>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>A-B-O blood type problem</p>
<p>Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th>genotype</th>
<th>AA</th>
<th>BB</th>
<th>OO</th>
<th>AO</th>
<th>BO</th>
<th>AB</th>
<th>Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Frequency</td>
<td><span class="math inline">\(p^2\)</span></td>
<td><span class="math inline">\(q^2\)</span></td>
<td><span class="math inline">\(r^2\)</span></td>
<td>2pr</td>
<td>2qr</td>
<td>2pq</td>
<td>1</td>
</tr>
<tr class="even">
<td>Count</td>
<td>nAA</td>
<td>nBB</td>
<td>nOO</td>
<td>nAO</td>
<td>nBO</td>
<td>nAB</td>
<td>n</td>
</tr>
</tbody>
</table>
<p>Observed data: nA = nAA + nAO = 444 (A-type),nB = nBB + nBO = 132 (B-type), nOO = 361 (O-type),nAB = 63 (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>set <span class="math inline">\(Z1\)</span> denoting the observations of AA;set <span class="math inline">\(Z2\)</span> denoting the observations of BB.set <span class="math inline">\(f\)</span> denoting the likelihood function weeding out the constant. <span class="math display">\[
\begin{align}
f&amp;=(p^2)^{Z1}(q^2)^{Z2}(r^2)^{n_oo}(2pr)^{n_{A.}-Z1}(2qr)^{n_{B.}-Z2}(2pq)^{n_{AB}}\\
&amp;=p^{Z1+n_{A.}+n_{AB}} q^{Z2+n_{B.}+n_{AB}} r^{2n_{oo}+n_{A.}+n_{B.}-Z1-Z2} 2^{n_{A.}+n_{B.}+n_{AB}-Z1-Z2}
\end{align}
\]</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
lnf=(Z1+n_{A.}+n_{AB})lnp+(Z2+n_{B.}+n_{AB})lnq+(2n_{oo}+n_{A.}+n_{B.}-Z1-Z2)lnr
\]</span> noting:<span class="math inline">\(lnf\)</span> weeded out something that is unrelated with p or q.</p>
<p><span class="math inline">\(\because\)</span> <span class="math display">\[
Z1\sim B\left(n_{A.},\frac{p}{p+2r}\right);
Z2\sim B\left(n_{B.},\frac{q}{q+2r}\right)
\]</span> <span class="math inline">\(\therefore\)</span> when <span class="math inline">\(n_{A.},n_{B.}\)</span> are available and <span class="math inline">\(p=p^{(i)}\)</span>; <span class="math inline">\(q=q^{(i)}\)</span>; <span class="math inline">\(r=r^{(i)}\)</span> <span class="math display">\[
EZ1=n_{A.} \frac{p^{(i)}}{p^{(i)}+2r^{(i)}};EZ2=n_{B.} \frac{q^{(i)}}{q^{(i)}+2r^{(i)}}
\]</span> set <span class="math display">\[
k1=EZ1+n_{A.}+n_{AB};k2=EZ2+n_{B.}+n_{AB};k3=2n_{oo}+n_{A.}+n_{B.}-EZ1-EZ2
\]</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
Elnf=k1lnp+k2lnq+k3ln(1-p-q)
\]</span> <span class="math inline">\(\therefore\)</span> <span class="math display">\[
\frac{\partial Elnf}{\partial p}=\frac{k1}{p}-\frac{k3}{1-p-q}\\
\frac{\partial Elnf}{\partial q}=\frac{k2}{q}-\frac{k3}{1-p-q}
\]</span> solving the equation set</p>
<p>set <span class="math inline">\(n=n_{A.}+n_{B.}+n_{AB}+n_{oo}\)</span> <span class="math display">\[
\begin{align}
p^{(i+1)}&amp;=\frac{k1}{k1+k2+k3}\\
&amp;=\frac{1}{2n}(EZ1+n_{A.}+n_{AB})
\end{align}
\]</span> <span class="math display">\[
\begin{align}
q^{(i+1)}&amp;=\frac{k2}{k1+k2+k3}\\
&amp;=\frac{1}{2n}(EZ2+n_{B.}+n_{AB})
\end{align}
\]</span> codes as follows:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>na&lt;-<span class="dv">444</span>;nb&lt;-<span class="dv">132</span>;nab&lt;-<span class="dv">63</span>;noo&lt;-<span class="dv">361</span></span>
<span id="cb86-2"><a href="#cb86-2"></a>n&lt;-na<span class="op">+</span>nb<span class="op">+</span>nab<span class="op">+</span>noo</span>
<span id="cb86-3"><a href="#cb86-3"></a>pf&lt;-<span class="cf">function</span>(p,q){</span>
<span id="cb86-4"><a href="#cb86-4"></a>  y&lt;-na<span class="op">*</span>p<span class="op">/</span>(p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))</span>
<span id="cb86-5"><a href="#cb86-5"></a>  yy&lt;-(y<span class="op">+</span>na<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb86-6"><a href="#cb86-6"></a>  <span class="kw">return</span>(yy)</span>
<span id="cb86-7"><a href="#cb86-7"></a>}</span>
<span id="cb86-8"><a href="#cb86-8"></a>qf&lt;-<span class="cf">function</span>(p,q){</span>
<span id="cb86-9"><a href="#cb86-9"></a>  y&lt;-nb<span class="op">*</span>q<span class="op">/</span>(q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))</span>
<span id="cb86-10"><a href="#cb86-10"></a>  yy&lt;-(y<span class="op">+</span>nb<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb86-11"><a href="#cb86-11"></a>  <span class="kw">return</span>(yy)</span>
<span id="cb86-12"><a href="#cb86-12"></a>}</span>
<span id="cb86-13"><a href="#cb86-13"></a>p1&lt;-<span class="fl">0.5</span>;q1&lt;-<span class="fl">0.3</span></span>
<span id="cb86-14"><a href="#cb86-14"></a>p&lt;-<span class="kw">numeric</span>();i&lt;-<span class="dv">1</span>;q&lt;-<span class="kw">numeric</span>()</span>
<span id="cb86-15"><a href="#cb86-15"></a><span class="cf">while</span>(p1 <span class="op">!=</span><span class="st"> </span><span class="kw">pf</span>(p1,q1) <span class="op">|</span><span class="st"> </span>q1 <span class="op">!=</span><span class="st"> </span><span class="kw">qf</span>(p1,q1)){</span>
<span id="cb86-16"><a href="#cb86-16"></a>  p[i]&lt;-<span class="kw">pf</span>(p1,q1)</span>
<span id="cb86-17"><a href="#cb86-17"></a>  q[i]&lt;-<span class="kw">qf</span>(p1,q1)</span>
<span id="cb86-18"><a href="#cb86-18"></a>  i&lt;-i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb86-19"><a href="#cb86-19"></a>  p1&lt;-<span class="kw">pf</span>(p1,q1)</span>
<span id="cb86-20"><a href="#cb86-20"></a>  q1&lt;-<span class="kw">qf</span>(p1,q1)</span>
<span id="cb86-21"><a href="#cb86-21"></a>}</span>
<span id="cb86-22"><a href="#cb86-22"></a><span class="kw">print</span>(p1)</span></code></pre></div>
<pre><code>## [1] 0.2976407</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="kw">print</span>(q1)</span></code></pre></div>
<pre><code>## [1] 0.1027063</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>##  [1] 0.3768333 0.3138446 0.3006184 0.2981759 0.2977364 0.2976578 0.2976437
##  [8] 0.2976412 0.2976408 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407
## [15] 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407
## [22] 0.2976407</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="kw">print</span>(q)</span></code></pre></div>
<pre><code>##  [1] 0.1257857 0.1044295 0.1028969 0.1027346 0.1027110 0.1027071 0.1027064
##  [8] 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063
## [15] 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063
## [22] 0.1027063</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># compute the corresponding</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="co">#log-maximum likelihood values</span></span>
<span id="cb94-3"><a href="#cb94-3"></a>ez1&lt;-na<span class="op">*</span>p<span class="op">/</span>(p<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))</span>
<span id="cb94-4"><a href="#cb94-4"></a>ez2&lt;-nb<span class="op">*</span>q<span class="op">/</span>(q<span class="op">+</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q<span class="op">-</span>p))</span>
<span id="cb94-5"><a href="#cb94-5"></a>k1&lt;-nab<span class="op">+</span>na<span class="op">+</span>ez1</span>
<span id="cb94-6"><a href="#cb94-6"></a>k2&lt;-nab<span class="op">+</span>nb<span class="op">+</span>ez2</span>
<span id="cb94-7"><a href="#cb94-7"></a>k3&lt;-<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>na<span class="op">+</span>nb<span class="op">-</span>ez1<span class="op">-</span>ez2</span>
<span id="cb94-8"><a href="#cb94-8"></a>elnf&lt;-k1<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span>k2<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span>k3<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)</span>
<span id="cb94-9"><a href="#cb94-9"></a><span class="kw">print</span>(elnf)</span></code></pre></div>
<pre><code>##  [1] -1859.827 -1808.174 -1803.138 -1802.385 -1802.255 -1802.232 -1802.228
##  [8] -1802.227 -1802.227 -1802.227 -1802.227 -1802.227 -1802.227 -1802.227
## [15] -1802.227 -1802.227 -1802.227 -1802.227 -1802.227 -1802.227 -1802.227
## [22] -1802.227</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="kw">plot</span>(elnf,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the results above, they are increasing.</p>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb97-2"><a href="#cb97-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb97-3"><a href="#cb97-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb97-4"><a href="#cb97-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb97-5"><a href="#cb97-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb97-6"><a href="#cb97-6"></a>)</span></code></pre></div>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb98-2"><a href="#cb98-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb98-3"><a href="#cb98-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb98-4"><a href="#cb98-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb98-5"><a href="#cb98-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb98-6"><a href="#cb98-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb98-7"><a href="#cb98-7"></a>)</span>
<span id="cb98-8"><a href="#cb98-8"></a>formulas&lt;-<span class="st"> </span><span class="kw">as.character</span>(formulas)</span>
<span id="cb98-9"><a href="#cb98-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="kw">length</span>(formulas)){</span>
<span id="cb98-10"><a href="#cb98-10"></a>  t&lt;-<span class="kw">lm</span>(formulas[i])</span>
<span id="cb98-11"><a href="#cb98-11"></a>  <span class="kw">print</span>(t)</span>
<span id="cb98-12"><a href="#cb98-12"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[i])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[i])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[i])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[i])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="kw">lapply</span>(formulas,<span class="cf">function</span>(x) <span class="kw">lm</span>(x))</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="dv">100</span>,</span>
<span id="cb103-3"><a href="#cb103-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb103-4"><a href="#cb103-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb103-5"><a href="#cb103-5"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using directly Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.351808782 0.086303350 0.826592949 0.904182059 0.860757297 0.695909067
##   [7] 0.221824302 1.000000000 0.017451135 0.775226161 0.095531813 0.741537578
##  [13] 0.368063815 0.183839329 0.291349416 0.163018279 0.646558221 0.188241001
##  [19] 0.467723825 0.459330223 0.283026018 0.302055768 0.468022490 0.161371293
##  [25] 0.325773549 0.658728527 0.862850549 0.436824656 0.717448744 0.630362036
##  [31] 0.658130921 0.127344653 0.668347413 0.264357225 0.850336936 0.085609314
##  [37] 0.882587464 0.123887562 0.541999241 0.046378097 0.876609657 0.476359247
##  [43] 0.444231076 0.061338179 0.348252709 0.227385264 0.079024322 0.596255624
##  [49] 0.544198614 0.123016454 0.334123540 0.562317356 0.040764769 0.101380668
##  [55] 0.270062531 0.317320678 0.934676525 0.105407782 0.332319184 0.142980114
##  [61] 0.621014537 0.817425926 0.434214074 0.272936728 0.924079592 0.756968015
##  [67] 0.165691675 0.744523013 0.232518413 0.117032936 0.530576367 0.922844486
##  [73] 0.194811783 0.890017907 0.993110426 0.194946247 0.758398294 0.836308055
##  [79] 0.261153366 0.852498375 0.168347371 0.241639798 0.491872135 0.579113335
##  [85] 0.007384905 0.440181994 0.541124791 0.118824789 0.419667580 0.698180376
##  [91] 0.993704480 0.262959219 0.733629838 0.397048175 0.153477782 0.760357229
##  [97] 0.938135894 0.506414985 0.304135682 0.241928487</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># extra challenge</span></span>
<span id="cb106-2"><a href="#cb106-2"></a>x&lt;-<span class="kw">numeric</span>()</span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(trials)){</span>
<span id="cb106-4"><a href="#cb106-4"></a>  x[i]&lt;-trials[[i]]<span class="op">$</span>p.value</span>
<span id="cb106-5"><a href="#cb106-5"></a>}</span>
<span id="cb106-6"><a href="#cb106-6"></a><span class="kw">print</span>(x)</span></code></pre></div>
<pre><code>##   [1] 0.351808782 0.086303350 0.826592949 0.904182059 0.860757297 0.695909067
##   [7] 0.221824302 1.000000000 0.017451135 0.775226161 0.095531813 0.741537578
##  [13] 0.368063815 0.183839329 0.291349416 0.163018279 0.646558221 0.188241001
##  [19] 0.467723825 0.459330223 0.283026018 0.302055768 0.468022490 0.161371293
##  [25] 0.325773549 0.658728527 0.862850549 0.436824656 0.717448744 0.630362036
##  [31] 0.658130921 0.127344653 0.668347413 0.264357225 0.850336936 0.085609314
##  [37] 0.882587464 0.123887562 0.541999241 0.046378097 0.876609657 0.476359247
##  [43] 0.444231076 0.061338179 0.348252709 0.227385264 0.079024322 0.596255624
##  [49] 0.544198614 0.123016454 0.334123540 0.562317356 0.040764769 0.101380668
##  [55] 0.270062531 0.317320678 0.934676525 0.105407782 0.332319184 0.142980114
##  [61] 0.621014537 0.817425926 0.434214074 0.272936728 0.924079592 0.756968015
##  [67] 0.165691675 0.744523013 0.232518413 0.117032936 0.530576367 0.922844486
##  [73] 0.194811783 0.890017907 0.993110426 0.194946247 0.758398294 0.836308055
##  [79] 0.261153366 0.852498375 0.168347371 0.241639798 0.491872135 0.579113335
##  [85] 0.007384905 0.440181994 0.541124791 0.118824789 0.419667580 0.698180376
##  [91] 0.993704480 0.262959219 0.733629838 0.397048175 0.153477782 0.760357229
##  [97] 0.938135894 0.506414985 0.304135682 0.241928487</code></pre>
</div>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb108-2"><a href="#cb108-2"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb108-3"><a href="#cb108-3"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb108-4"><a href="#cb108-4"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</span>
<span id="cb108-5"><a href="#cb108-5"></a>  out</span>
<span id="cb108-6"><a href="#cb108-6"></a>}</span>
<span id="cb108-7"><a href="#cb108-7"></a><span class="kw">f</span>(<span class="kw">list</span>(mtcars),sum, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [[1]]
##      mpg      cyl     disp       hp     drat       wt     qsec       vs 
##  642.900  198.000 7383.100 4694.000  115.090  102.952  571.160   14.000 
##       am     gear     carb 
##   13.000  118.000   90.000</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">detach</span>(mtcars)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
